var t={};(()=>{t.d=(e,n)=>{for(var i in n){if(t.o(n,i)&&!t.o(e,i)){Object.defineProperty(e,i,{enumerable:true,get:n[i]})}}}})();(()=>{t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})();(()=>{t.r=t=>{if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(t,"__esModule",{value:true})}})();if(typeof t!=="undefined")t.ab=new URL(".",import.meta.url).pathname.slice(import.meta.url.match(/^file:\/\/\/\w:/)?1:0,-1)+"/";var e={};var n={};t.r(n);t.d(n,{A:()=>A,Animator:()=>it,Array:()=>SVGArray,Box:()=>Box,Circle:()=>Circle,ClipPath:()=>ClipPath,Color:()=>Color,Container:()=>Container,Controller:()=>Controller,Defs:()=>Defs,Dom:()=>Dom,Ease:()=>Ease,Element:()=>Element,Ellipse:()=>Ellipse,EventTarget:()=>EventTarget,ForeignObject:()=>ForeignObject,Fragment:()=>Fragment,G:()=>G,Gradient:()=>Gradient,Image:()=>Image,Line:()=>Line,List:()=>List,Marker:()=>Marker,Mask:()=>Mask,Matrix:()=>Matrix,Morphable:()=>Morphable,NonMorphable:()=>NonMorphable,Number:()=>SVGNumber,ObjectBag:()=>ObjectBag,PID:()=>PID,Path:()=>Path,PathArray:()=>PathArray,Pattern:()=>Pattern,Point:()=>Point,PointArray:()=>PointArray,Polygon:()=>Polygon,Polyline:()=>Polyline,Queue:()=>Queue,Rect:()=>Rect,Runner:()=>Runner,SVG:()=>ot,Shape:()=>Shape,Spring:()=>Spring,Stop:()=>Stop,Style:()=>Style,Svg:()=>Svg,Symbol:()=>Symbol,Text:()=>Text,TextPath:()=>TextPath,Timeline:()=>Timeline,TransformBag:()=>TransformBag,Tspan:()=>Tspan,Use:()=>Use,adopt:()=>adopt,assignNewId:()=>assignNewId,clearEvents:()=>clearEvents,create:()=>create,defaults:()=>V,dispatch:()=>dispatch,easing:()=>Q,eid:()=>eid,extend:()=>extend,find:()=>baseFind,getClass:()=>getClass,getEventTarget:()=>getEventTarget,getEvents:()=>getEvents,getWindow:()=>getWindow,makeInstance:()=>makeInstance,makeMorphable:()=>makeMorphable,mockAdopt:()=>mockAdopt,namespaces:()=>u,nodeOrNew:()=>nodeOrNew,off:()=>off,on:()=>on,parser:()=>parser,regex:()=>L,register:()=>register,registerMorphableType:()=>registerMorphableType,registerWindow:()=>registerWindow,restoreWindow:()=>restoreWindow,root:()=>g,saveWindow:()=>saveWindow,utils:()=>s,windowEvents:()=>j,withWindow:()=>withWindow,wrapWithAttrCheck:()=>wrapWithAttrCheck});class EventEmitter{constructor(t){this.eventType=t;this.handlers=[]}fire(t){if(Object.hasOwnProperty.call(this.handlers,t)){if(typeof this.handlers[t]==="function"){this.handlers[t](t,this);return this}else if(this.handlers[t]instanceof Array){let e=false;for(const n of this.handlers[t]){if(typeof n==="function"){e=true;n(t,this)}}if(e)return this}}return this}on(t,e,n){if(typeof e!=="function")return;if(typeof this.handlers[t]==="function"){this.handlers[t]=[this.handlers[t],e.bind(n)]}else if(this.handlers[t]instanceof Array){this.handlers[t].push(e.bind(n))}else{this.handlers[t]=e.bind(n)}}}EventEmitter.eventType={};function definePrivateProperties(t,...e){for(const n of e){Object.defineProperty(t,n,{enumerable:false,writable:true})}return t}function round(t,e){function shift(t,e){const n=(""+t).split("e");return+(n[0]+"e"+(n[1]?+n[1]+e:e))}return shift(Math.round(shift(t,+e)),-e)}function map(t,e,n=0,i=1){return r=>n+i*(r-t)/e}function mapClamped(t,e,n=0,i=1){return r=>n+i*clamp((r-t)/e)}const clamp=(t,e=0,n=1)=>Math.max(e,Math.min(n,t));const lerp=(t,e,n)=>t*(1-n)+e*n;const prettyPrintPercent=t=>`${Math.round(t*100)}%`;function mulberry32(t){return function(){var e=t+=1831565813;e=Math.imul(e^e>>>15,e|1);e^=e+Math.imul(e^e>>>7,e|61);return((e^e>>>14)>>>0)/4294967296}}const seedRandom=t=>mulberry32(t||t+1)();const centeredUnitRandom=t=>2*(seedRandom(t)-.5);class Class{constructor(){this.dominance=0,this.rank=0,this.centroid=0,this.centroidNormal=0,this.count=0}}class Criterion extends EventEmitter{constructor({name:t,description:e,min:n,max:i,sortingorder:r}){super(Criterion.eventType);this.name=t;this.description=e||t;this.min=+n||0;this.max=+i||5;this.maxDominance=0;this.classes=[];this.classCount=0;this.sortingorder=r;definePrivateProperties(this,"_weight","_blur")}update(){this.fire(Criterion.eventType.updated)}blur(t){const e=this.sortingorder==="ascending"?-2:2;const n=this.max-this.min;const i=e*this.blurIntensity*n;return Math.min(this.max,Math.max(this.min,t+i))}set weight(t){this._weight=Math.max(0,t);this.fire(Criterion.eventType.weightUpdated);this.fire(Criterion.eventType.updated);return t}get weight(){return this._weight||0}set blurIntensity(t){this._blur=Math.max(0,t);this.fire(Criterion.eventType.blurIntensityUpdated);this.fire(Criterion.eventType.updated);return t}get blurIntensity(){return this._blur||0}export(){return{name:this.name,weight:this.weight,blurIntensity:this.blurIntensity}}}Criterion.eventType={updated:"updated",blurIntensityUpdated:"blurIntensityUpdated",weightUpdated:"weightUpdated"};class Technology{constructor({technology:t,name:e,description:n,evaluations:i}){this.name=t||e;this.description=n||t;this.evaluations=i||{};this.bounds={};this.dominance={};this.rank={};this.sortingorder={};this.score=0;this.selected=false}updateBounds(t){for(const e of t){this.bounds[e.name]=e.blur(this.evaluations[e.name]);this.dominance[e.name]=0}return this}updateDominance(t,e){for(const n of t){this.dominance[n.name]=0;for(const t of e){if(t!==this){if(n.sortingorder=="ascending"&&this.bounds[n.name]>t.evaluations[n.name])this.dominance[n.name]++;if(n.sortingorder=="descending"&&this.bounds[n.name]<t.evaluations[n.name])this.dominance[n.name]++}}}return this}updateScore(t){this.score=0;let e=0;for(const n of t.filter((t=>t.weight>0))){this.score+=n.weight*this.dominance[n.name]/n.maxDominance;e+=n.weight}this.score/=e;return this}}class Sorter extends EventEmitter{constructor(t,e){super();this.technologies=t;this.criteria=e;definePrivateProperties(this,"_technologies","_criteria")}set technologies(t){this._technologies={all:[],sorted:[],map:{}};for(const e of t){const t=new Technology(e);this._technologies.all.push(t);this._technologies.map[t.name]=t}}get technologies(){return this._technologies}set criteria(t){this._criteria={all:[],map:{},updated:[]};for(const e of t){const t=new Criterion(e);this._criteria.map[t.name]=t;this._criteria.all.push(t);t.on(Criterion.eventType.updated,((t,e)=>{this._criteria.updated.push(e);this.sort()}),this)}this._criteria.updated=this._criteria.all.slice()}get criteria(){return this._criteria}sort(){this.updateBounds().updateDominance().normalizeDominance().updateScore();this.technologies.sorted=this.technologies.all.slice().sort(((t,e)=>e.score-t.score));this.criteria.updated=[];this.fire(Sorter.eventType.sorted);return this}updateDominance(){this.technologies.all.forEach((t=>t.updateDominance(this.criteria.updated,this.technologies.all)));return this}updateBounds(){this.technologies.all.forEach((t=>t.updateBounds(this.criteria.updated)));return this}normalizeDominance(){for(const t of this.criteria.all){t.maxDominance=this.technologies.all.reduce(((e,n)=>Math.max(e,n.dominance[t.name])),0);const e=[...new Set(this.technologies.all.map((e=>+e.dominance[t.name])))].sort(((t,e)=>t-e));e.forEach(((e,n)=>{const i=this.technologies.all.filter((n=>n.dominance[t.name]===e));t.classes[e]={dominance:e,rank:n,centroid:i.reduce(((e,n)=>e+n.evaluations[t.name]),0)/i.length,centroidNormal:i.reduce(((e,n)=>e+n.evaluations[t.name]),0)/i.length/t.max,count:i.length}}));t.classCount=e.length;this.technologies.all.forEach((n=>n.rank[t.name]=e.indexOf(n.dominance[t.name])))}return this}updateScore(){this.technologies.all.forEach((t=>t.updateScore(this.criteria.all)));return this}}Sorter.eventType={sorted:"sorted"};
/*!
 * @svgdotjs/svg.js - A lightweight library for manipulating and animating SVG.
 * @version 3.1.2
 * https://svgjs.dev/
 *
 * @copyright Wout Fierens <wout@mick-wout.com>
 * @license MIT
 *
 * BUILT: Wed Jan 26 2022 23:19:07 GMT+0100 (Mitteleurop√§ische Normalzeit)
 */
const i={};const r=[];function registerMethods(t,e){if(Array.isArray(t)){for(const n of t){registerMethods(n,e)}return}if(typeof t==="object"){for(const e in t){registerMethods(e,t[e])}return}addMethodNames(Object.getOwnPropertyNames(e));i[t]=Object.assign(i[t]||{},e)}function getMethodsFor(t){return i[t]||{}}function getMethodNames(){return[...new Set(r)]}function addMethodNames(t){r.push(...t)}function svg_esm_map(t,e){let n;const i=t.length;const r=[];for(n=0;n<i;n++){r.push(e(t[n]))}return r}function filter(t,e){let n;const i=t.length;const r=[];for(n=0;n<i;n++){if(e(t[n])){r.push(t[n])}}return r}function radians(t){return t%360*Math.PI/180}function degrees(t){return t*180/Math.PI%360}function camelCase(t){return t.toLowerCase().replace(/-(.)/g,(function(t,e){return e.toUpperCase()}))}function unCamelCase(t){return t.replace(/([A-Z])/g,(function(t,e){return"-"+e.toLowerCase()}))}function capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}function proportionalSize(t,e,n,i){if(e==null||n==null){i=i||t.bbox();if(e==null){e=i.width/i.height*n}else if(n==null){n=i.height/i.width*e}}return{width:e,height:n}}function getOrigin(t,e){const n=t.origin;let i=t.ox!=null?t.ox:t.originX!=null?t.originX:"center";let r=t.oy!=null?t.oy:t.originY!=null?t.originY:"center";if(n!=null){[i,r]=Array.isArray(n)?n:typeof n==="object"?[n.x,n.y]:[n,n]}const s=typeof i==="string";const o=typeof r==="string";if(s||o){const{height:t,width:n,x:a,y:h}=e.bbox();if(s){i=i.includes("left")?a:i.includes("right")?a+n:a+n/2}if(o){r=r.includes("top")?h:r.includes("bottom")?h+t:h+t/2}}return[i,r]}var s={__proto__:null,map:svg_esm_map,filter:filter,radians:radians,degrees:degrees,camelCase:camelCase,unCamelCase:unCamelCase,capitalize:capitalize,proportionalSize:proportionalSize,getOrigin:getOrigin};const o="http://www.w3.org/2000/svg";const a="http://www.w3.org/1999/xhtml";const h="http://www.w3.org/2000/xmlns/";const l="http://www.w3.org/1999/xlink";const c="http://svgjs.dev/svgjs";var u={__proto__:null,svg:o,html:a,xmlns:h,xlink:l,svgjs:c};const d={window:typeof window==="undefined"?null:window,document:typeof document==="undefined"?null:document};function registerWindow(t=null,e=null){d.window=t;d.document=e}const m={};function saveWindow(){m.window=d.window;m.document=d.document}function restoreWindow(){d.window=m.window;d.document=m.document}function withWindow(t,e){saveWindow();registerWindow(t,t.document);e(t,t.document);restoreWindow()}function getWindow(){return d.window}class Base{}const p={};const g="___SYMBOL___ROOT___";function create(t,e=o){return d.document.createElementNS(e,t)}function makeInstance(t,e=false){if(t instanceof Base)return t;if(typeof t==="object"){return w(t)}if(t==null){return new p[g]}if(typeof t==="string"&&t.charAt(0)!=="<"){return w(d.document.querySelector(t))}const n=e?d.document.createElement("div"):create("svg");n.innerHTML=t;t=w(n.firstChild);n.removeChild(n.firstChild);return t}function nodeOrNew(t,e){return e&&e.ownerDocument&&e instanceof e.ownerDocument.defaultView.Node?e:create(t)}function adopt(t){if(!t)return null;if(t.instance instanceof Base)return t.instance;if(t.nodeName==="#document-fragment"){return new p.Fragment(t)}let e=capitalize(t.nodeName||"Dom");if(e==="LinearGradient"||e==="RadialGradient"){e="Gradient"}else if(!p[e]){e="Dom"}return new p[e](t)}let w=adopt;function mockAdopt(t=adopt){w=t}function register(t,e=t.name,n=false){p[e]=t;if(n)p[g]=t;addMethodNames(Object.getOwnPropertyNames(t.prototype));return t}function getClass(t){return p[t]}let b=1e3;function eid(t){return"Svgjs"+capitalize(t)+b++}function assignNewId(t){for(let e=t.children.length-1;e>=0;e--){assignNewId(t.children[e])}if(t.id){t.id=eid(t.nodeName);return t}return t}function extend(t,e){let n,i;t=Array.isArray(t)?t:[t];for(i=t.length-1;i>=0;i--){for(n in e){t[i].prototype[n]=e[n]}}}function wrapWithAttrCheck(t){return function(...e){const n=e[e.length-1];if(n&&n.constructor===Object&&!(n instanceof Array)){return t.apply(this,e.slice(0,-1)).attr(n)}else{return t.apply(this,e)}}}function siblings(){return this.parent().children()}function position(){return this.parent().index(this)}function next(){return this.siblings()[this.position()+1]}function prev(){return this.siblings()[this.position()-1]}function forward(){const t=this.position();const e=this.parent();e.add(this.remove(),t+1);return this}function backward(){const t=this.position();const e=this.parent();e.add(this.remove(),t?t-1:0);return this}function front(){const t=this.parent();t.add(this.remove());return this}function back(){const t=this.parent();t.add(this.remove(),0);return this}function before(t){t=makeInstance(t);t.remove();const e=this.position();this.parent().add(t,e);return this}function after(t){t=makeInstance(t);t.remove();const e=this.position();this.parent().add(t,e+1);return this}function insertBefore(t){t=makeInstance(t);t.before(this);return this}function insertAfter(t){t=makeInstance(t);t.after(this);return this}registerMethods("Dom",{siblings:siblings,position:position,next:next,prev:prev,forward:forward,backward:backward,front:front,back:back,before:before,after:after,insertBefore:insertBefore,insertAfter:insertAfter});const v=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i;const _=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;const C=/rgb\((\d+),(\d+),(\d+)\)/;const M=/(#[a-z_][a-z0-9\-_]*)/i;const S=/\)\s*,?\s*/;const k=/\s/g;const T=/^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i;const P=/^rgb\(/;const O=/^(\s+)?$/;const N=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;const E=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i;const I=/[\s,]+/;const D=/[MLHVCSQTAZ]/i;var L={__proto__:null,numberAndUnit:v,hex:_,rgb:C,reference:M,transforms:S,whitespace:k,isHex:T,isRgb:P,isBlank:O,isNumber:N,isImage:E,delimiter:I,isPathLetter:D};function classes(){const t=this.attr("class");return t==null?[]:t.trim().split(I)}function hasClass(t){return this.classes().indexOf(t)!==-1}function addClass(t){if(!this.hasClass(t)){const e=this.classes();e.push(t);this.attr("class",e.join(" "))}return this}function removeClass(t){if(this.hasClass(t)){this.attr("class",this.classes().filter((function(e){return e!==t})).join(" "))}return this}function toggleClass(t){return this.hasClass(t)?this.removeClass(t):this.addClass(t)}registerMethods("Dom",{classes:classes,hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass});function css(t,e){const n={};if(arguments.length===0){this.node.style.cssText.split(/\s*;\s*/).filter((function(t){return!!t.length})).forEach((function(t){const e=t.split(/\s*:\s*/);n[e[0]]=e[1]}));return n}if(arguments.length<2){if(Array.isArray(t)){for(const e of t){const t=camelCase(e);n[e]=this.node.style[t]}return n}if(typeof t==="string"){return this.node.style[camelCase(t)]}if(typeof t==="object"){for(const e in t){this.node.style[camelCase(e)]=t[e]==null||O.test(t[e])?"":t[e]}}}if(arguments.length===2){this.node.style[camelCase(t)]=e==null||O.test(e)?"":e}return this}function show(){return this.css("display","")}function hide(){return this.css("display","none")}function visible(){return this.css("display")!=="none"}registerMethods("Dom",{css:css,show:show,hide:hide,visible:visible});function data(t,e,n){if(t==null){return this.data(svg_esm_map(filter(this.node.attributes,(t=>t.nodeName.indexOf("data-")===0)),(t=>t.nodeName.slice(5))))}else if(t instanceof Array){const e={};for(const n of t){e[n]=this.data(n)}return e}else if(typeof t==="object"){for(e in t){this.data(e,t[e])}}else if(arguments.length<2){try{return JSON.parse(this.attr("data-"+t))}catch(e){return this.attr("data-"+t)}}else{this.attr("data-"+t,e===null?null:n===true||typeof e==="string"||typeof e==="number"?e:JSON.stringify(e))}return this}registerMethods("Dom",{data:data});function remember(t,e){if(typeof arguments[0]==="object"){for(const e in t){this.remember(e,t[e])}}else if(arguments.length===1){return this.memory()[t]}else{this.memory()[t]=e}return this}function forget(){if(arguments.length===0){this._memory={}}else{for(let t=arguments.length-1;t>=0;t--){delete this.memory()[arguments[t]]}}return this}function memory(){return this._memory=this._memory||{}}registerMethods("Dom",{remember:remember,forget:forget,memory:memory});function sixDigitHex(t){return t.length===4?["#",t.substring(1,2),t.substring(1,2),t.substring(2,3),t.substring(2,3),t.substring(3,4),t.substring(3,4)].join(""):t}function componentHex(t){const e=Math.round(t);const n=Math.max(0,Math.min(255,e));const i=n.toString(16);return i.length===1?"0"+i:i}function is(t,e){for(let n=e.length;n--;){if(t[e[n]]==null){return false}}return true}function getParameters(t,e){const n=is(t,"rgb")?{_a:t.r,_b:t.g,_c:t.b,_d:0,space:"rgb"}:is(t,"xyz")?{_a:t.x,_b:t.y,_c:t.z,_d:0,space:"xyz"}:is(t,"hsl")?{_a:t.h,_b:t.s,_c:t.l,_d:0,space:"hsl"}:is(t,"lab")?{_a:t.l,_b:t.a,_c:t.b,_d:0,space:"lab"}:is(t,"lch")?{_a:t.l,_b:t.c,_c:t.h,_d:0,space:"lch"}:is(t,"cmyk")?{_a:t.c,_b:t.m,_c:t.y,_d:t.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};n.space=e||n.space;return n}function cieSpace(t){if(t==="lab"||t==="xyz"||t==="lch"){return true}else{return false}}function hueToRgb(t,e,n){if(n<0)n+=1;if(n>1)n-=1;if(n<1/6)return t+(e-t)*6*n;if(n<1/2)return e;if(n<2/3)return t+(e-t)*(2/3-n)*6;return t}class Color{constructor(...t){this.init(...t)}static isColor(t){return t&&(t instanceof Color||this.isRgb(t)||this.test(t))}static isRgb(t){return t&&typeof t.r==="number"&&typeof t.g==="number"&&typeof t.b==="number"}static random(t="vibrant",e,n){const{random:i,round:r,sin:s,PI:o}=Math;if(t==="vibrant"){const t=(81-57)*i()+57;const e=(83-45)*i()+45;const n=360*i();const r=new Color(t,e,n,"lch");return r}else if(t==="sine"){e=e==null?i():e;const t=r(80*s(2*o*e/.5+.01)+150);const n=r(50*s(2*o*e/.5+4.6)+200);const a=r(100*s(2*o*e/.5+2.3)+150);const h=new Color(t,n,a);return h}else if(t==="pastel"){const t=(94-86)*i()+86;const e=(26-9)*i()+9;const n=360*i();const r=new Color(t,e,n,"lch");return r}else if(t==="dark"){const t=10+10*i();const e=(125-75)*i()+86;const n=360*i();const r=new Color(t,e,n,"lch");return r}else if(t==="rgb"){const t=255*i();const e=255*i();const n=255*i();const r=new Color(t,e,n);return r}else if(t==="lab"){const t=100*i();const e=256*i()-128;const n=256*i()-128;const r=new Color(t,e,n,"lab");return r}else if(t==="grey"){const t=255*i();const e=new Color(t,t,t);return e}else{throw new Error("Unsupported random color mode")}}static test(t){return typeof t==="string"&&(T.test(t)||P.test(t))}cmyk(){const{_a:t,_b:e,_c:n}=this.rgb();const[i,r,s]=[t,e,n].map((t=>t/255));const o=Math.min(1-i,1-r,1-s);if(o===1){return new Color(0,0,0,1,"cmyk")}const a=(1-i-o)/(1-o);const h=(1-r-o)/(1-o);const l=(1-s-o)/(1-o);const c=new Color(a,h,l,o,"cmyk");return c}hsl(){const{_a:t,_b:e,_c:n}=this.rgb();const[i,r,s]=[t,e,n].map((t=>t/255));const o=Math.max(i,r,s);const a=Math.min(i,r,s);const h=(o+a)/2;const l=o===a;const c=o-a;const u=l?0:h>.5?c/(2-o-a):c/(o+a);const d=l?0:o===i?((r-s)/c+(r<s?6:0))/6:o===r?((s-i)/c+2)/6:o===s?((i-r)/c+4)/6:0;const m=new Color(360*d,100*u,100*h,"hsl");return m}init(t=0,e=0,n=0,i=0,r="rgb"){t=!t?0:t;if(this.space){for(const t in this.space){delete this[this.space[t]]}}if(typeof t==="number"){r=typeof i==="string"?i:r;i=typeof i==="string"?0:i;Object.assign(this,{_a:t,_b:e,_c:n,_d:i,space:r})}else if(t instanceof Array){this.space=e||(typeof t[3]==="string"?t[3]:t[4])||"rgb";Object.assign(this,{_a:t[0],_b:t[1],_c:t[2],_d:t[3]||0})}else if(t instanceof Object){const n=getParameters(t,e);Object.assign(this,n)}else if(typeof t==="string"){if(P.test(t)){const e=t.replace(k,"");const[n,i,r]=C.exec(e).slice(1,4).map((t=>parseInt(t)));Object.assign(this,{_a:n,_b:i,_c:r,_d:0,space:"rgb"})}else if(T.test(t)){const hexParse=t=>parseInt(t,16);const[,e,n,i]=_.exec(sixDigitHex(t)).map(hexParse);Object.assign(this,{_a:e,_b:n,_c:i,_d:0,space:"rgb"})}else throw Error("Unsupported string format, can't construct Color")}const{_a:s,_b:o,_c:a,_d:h}=this;const l=this.space==="rgb"?{r:s,g:o,b:a}:this.space==="xyz"?{x:s,y:o,z:a}:this.space==="hsl"?{h:s,s:o,l:a}:this.space==="lab"?{l:s,a:o,b:a}:this.space==="lch"?{l:s,c:o,h:a}:this.space==="cmyk"?{c:s,m:o,y:a,k:h}:{};Object.assign(this,l)}lab(){const{x:t,y:e,z:n}=this.xyz();const i=116*e-16;const r=500*(t-e);const s=200*(e-n);const o=new Color(i,r,s,"lab");return o}lch(){const{l:t,a:e,b:n}=this.lab();const i=Math.sqrt(e**2+n**2);let r=180*Math.atan2(n,e)/Math.PI;if(r<0){r*=-1;r=360-r}const s=new Color(t,i,r,"lch");return s}rgb(){if(this.space==="rgb"){return this}else if(cieSpace(this.space)){let{x:t,y:e,z:n}=this;if(this.space==="lab"||this.space==="lch"){let{l:i,a:r,b:s}=this;if(this.space==="lch"){const{c:t,h:e}=this;const n=Math.PI/180;r=t*Math.cos(n*e);s=t*Math.sin(n*e)}const o=(i+16)/116;const a=r/500+o;const h=o-s/200;const l=16/116;const c=.008856;const u=7.787;t=.95047*(a**3>c?a**3:(a-l)/u);e=1*(o**3>c?o**3:(o-l)/u);n=1.08883*(h**3>c?h**3:(h-l)/u)}const i=t*3.2406+e*-1.5372+n*-.4986;const r=t*-.9689+e*1.8758+n*.0415;const s=t*.0557+e*-.204+n*1.057;const o=Math.pow;const a=.0031308;const h=i>a?1.055*o(i,1/2.4)-.055:12.92*i;const l=r>a?1.055*o(r,1/2.4)-.055:12.92*r;const c=s>a?1.055*o(s,1/2.4)-.055:12.92*s;const u=new Color(255*h,255*l,255*c);return u}else if(this.space==="hsl"){let{h:t,s:e,l:n}=this;t/=360;e/=100;n/=100;if(e===0){n*=255;const t=new Color(n,n,n);return t}const i=n<.5?n*(1+e):n+e-n*e;const r=2*n-i;const s=255*hueToRgb(r,i,t+1/3);const o=255*hueToRgb(r,i,t);const a=255*hueToRgb(r,i,t-1/3);const h=new Color(s,o,a);return h}else if(this.space==="cmyk"){const{c:t,m:e,y:n,k:i}=this;const r=255*(1-Math.min(1,t*(1-i)+i));const s=255*(1-Math.min(1,e*(1-i)+i));const o=255*(1-Math.min(1,n*(1-i)+i));const a=new Color(r,s,o);return a}else{return this}}toArray(){const{_a:t,_b:e,_c:n,_d:i,space:r}=this;return[t,e,n,i,r]}toHex(){const[t,e,n]=this._clamped().map(componentHex);return`#${t}${e}${n}`}toRgb(){const[t,e,n]=this._clamped();const i=`rgb(${t},${e},${n})`;return i}toString(){return this.toHex()}xyz(){const{_a:t,_b:e,_c:n}=this.rgb();const[i,r,s]=[t,e,n].map((t=>t/255));const o=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92;const a=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;const h=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92;const l=(o*.4124+a*.3576+h*.1805)/.95047;const c=(o*.2126+a*.7152+h*.0722)/1;const u=(o*.0193+a*.1192+h*.9505)/1.08883;const d=l>.008856?Math.pow(l,1/3):7.787*l+16/116;const m=c>.008856?Math.pow(c,1/3):7.787*c+16/116;const p=u>.008856?Math.pow(u,1/3):7.787*u+16/116;const g=new Color(d,m,p,"xyz");return g}_clamped(){const{_a:t,_b:e,_c:n}=this.rgb();const{max:i,min:r,round:s}=Math;const format=t=>i(0,r(s(t),255));return[t,e,n].map(format)}}class Point{constructor(...t){this.init(...t)}clone(){return new Point(this)}init(t,e){const n={x:0,y:0};const i=Array.isArray(t)?{x:t[0],y:t[1]}:typeof t==="object"?{x:t.x,y:t.y}:{x:t,y:e};this.x=i.x==null?n.x:i.x;this.y=i.y==null?n.y:i.y;return this}toArray(){return[this.x,this.y]}transform(t){return this.clone().transformO(t)}transformO(t){if(!Matrix.isMatrixLike(t)){t=new Matrix(t)}const{x:e,y:n}=this;this.x=t.a*e+t.c*n+t.e;this.y=t.b*e+t.d*n+t.f;return this}}function point(t,e){return new Point(t,e).transform(this.screenCTM().inverse())}function closeEnough(t,e,n){return Math.abs(e-t)<(n||1e-6)}class Matrix{constructor(...t){this.init(...t)}static formatTransforms(t){const e=t.flip==="both"||t.flip===true;const n=t.flip&&(e||t.flip==="x")?-1:1;const i=t.flip&&(e||t.flip==="y")?-1:1;const r=t.skew&&t.skew.length?t.skew[0]:isFinite(t.skew)?t.skew:isFinite(t.skewX)?t.skewX:0;const s=t.skew&&t.skew.length?t.skew[1]:isFinite(t.skew)?t.skew:isFinite(t.skewY)?t.skewY:0;const o=t.scale&&t.scale.length?t.scale[0]*n:isFinite(t.scale)?t.scale*n:isFinite(t.scaleX)?t.scaleX*n:n;const a=t.scale&&t.scale.length?t.scale[1]*i:isFinite(t.scale)?t.scale*i:isFinite(t.scaleY)?t.scaleY*i:i;const h=t.shear||0;const l=t.rotate||t.theta||0;const c=new Point(t.origin||t.around||t.ox||t.originX,t.oy||t.originY);const u=c.x;const d=c.y;const m=new Point(t.position||t.px||t.positionX||NaN,t.py||t.positionY||NaN);const p=m.x;const g=m.y;const w=new Point(t.translate||t.tx||t.translateX,t.ty||t.translateY);const b=w.x;const v=w.y;const _=new Point(t.relative||t.rx||t.relativeX,t.ry||t.relativeY);const C=_.x;const M=_.y;return{scaleX:o,scaleY:a,skewX:r,skewY:s,shear:h,theta:l,rx:C,ry:M,tx:b,ty:v,ox:u,oy:d,px:p,py:g}}static fromArray(t){return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}}static isMatrixLike(t){return t.a!=null||t.b!=null||t.c!=null||t.d!=null||t.e!=null||t.f!=null}static matrixMultiply(t,e,n){const i=t.a*e.a+t.c*e.b;const r=t.b*e.a+t.d*e.b;const s=t.a*e.c+t.c*e.d;const o=t.b*e.c+t.d*e.d;const a=t.e+t.a*e.e+t.c*e.f;const h=t.f+t.b*e.e+t.d*e.f;n.a=i;n.b=r;n.c=s;n.d=o;n.e=a;n.f=h;return n}around(t,e,n){return this.clone().aroundO(t,e,n)}aroundO(t,e,n){const i=t||0;const r=e||0;return this.translateO(-i,-r).lmultiplyO(n).translateO(i,r)}clone(){return new Matrix(this)}decompose(t=0,e=0){const n=this.a;const i=this.b;const r=this.c;const s=this.d;const o=this.e;const a=this.f;const h=n*s-i*r;const l=h>0?1:-1;const c=l*Math.sqrt(n*n+i*i);const u=Math.atan2(l*i,l*n);const d=180/Math.PI*u;const m=Math.cos(u);const p=Math.sin(u);const g=(n*r+i*s)/h;const w=r*c/(g*n-i)||s*c/(g*i+n);const b=o-t+t*m*c+e*(g*m*c-p*w);const v=a-e+t*p*c+e*(g*p*c+m*w);return{scaleX:c,scaleY:w,shear:g,rotate:d,translateX:b,translateY:v,originX:t,originY:e,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}equals(t){if(t===this)return true;const e=new Matrix(t);return closeEnough(this.a,e.a)&&closeEnough(this.b,e.b)&&closeEnough(this.c,e.c)&&closeEnough(this.d,e.d)&&closeEnough(this.e,e.e)&&closeEnough(this.f,e.f)}flip(t,e){return this.clone().flipO(t,e)}flipO(t,e){return t==="x"?this.scaleO(-1,1,e,0):t==="y"?this.scaleO(1,-1,0,e):this.scaleO(-1,-1,t,e||t)}init(t){const e=Matrix.fromArray([1,0,0,1,0,0]);t=t instanceof Element?t.matrixify():typeof t==="string"?Matrix.fromArray(t.split(I).map(parseFloat)):Array.isArray(t)?Matrix.fromArray(t):typeof t==="object"&&Matrix.isMatrixLike(t)?t:typeof t==="object"?(new Matrix).transform(t):arguments.length===6?Matrix.fromArray([].slice.call(arguments)):e;this.a=t.a!=null?t.a:e.a;this.b=t.b!=null?t.b:e.b;this.c=t.c!=null?t.c:e.c;this.d=t.d!=null?t.d:e.d;this.e=t.e!=null?t.e:e.e;this.f=t.f!=null?t.f:e.f;return this}inverse(){return this.clone().inverseO()}inverseO(){const t=this.a;const e=this.b;const n=this.c;const i=this.d;const r=this.e;const s=this.f;const o=t*i-e*n;if(!o)throw new Error("Cannot invert "+this);const a=i/o;const h=-e/o;const l=-n/o;const c=t/o;const u=-(a*r+l*s);const d=-(h*r+c*s);this.a=a;this.b=h;this.c=l;this.d=c;this.e=u;this.f=d;return this}lmultiply(t){return this.clone().lmultiplyO(t)}lmultiplyO(t){const e=this;const n=t instanceof Matrix?t:new Matrix(t);return Matrix.matrixMultiply(n,e,this)}multiply(t){return this.clone().multiplyO(t)}multiplyO(t){const e=this;const n=t instanceof Matrix?t:new Matrix(t);return Matrix.matrixMultiply(e,n,this)}rotate(t,e,n){return this.clone().rotateO(t,e,n)}rotateO(t,e=0,n=0){t=radians(t);const i=Math.cos(t);const r=Math.sin(t);const{a:s,b:o,c:a,d:h,e:l,f:c}=this;this.a=s*i-o*r;this.b=o*i+s*r;this.c=a*i-h*r;this.d=h*i+a*r;this.e=l*i-c*r+n*r-e*i+e;this.f=c*i+l*r-e*r-n*i+n;return this}scale(t,e,n,i){return this.clone().scaleO(...arguments)}scaleO(t,e=t,n=0,i=0){if(arguments.length===3){i=n;n=e;e=t}const{a:r,b:s,c:o,d:a,e:h,f:l}=this;this.a=r*t;this.b=s*e;this.c=o*t;this.d=a*e;this.e=h*t-n*t+n;this.f=l*e-i*e+i;return this}shear(t,e,n){return this.clone().shearO(t,e,n)}shearO(t,e=0,n=0){const{a:i,b:r,c:s,d:o,e:a,f:h}=this;this.a=i+r*t;this.c=s+o*t;this.e=a+h*t-n*t;return this}skew(t,e,n,i){return this.clone().skewO(...arguments)}skewO(t,e=t,n=0,i=0){if(arguments.length===3){i=n;n=e;e=t}t=radians(t);e=radians(e);const r=Math.tan(t);const s=Math.tan(e);const{a:o,b:a,c:h,d:l,e:c,f:u}=this;this.a=o+a*r;this.b=a+o*s;this.c=h+l*r;this.d=l+h*s;this.e=c+u*r-i*r;this.f=u+c*s-n*s;return this}skewX(t,e,n){return this.skew(t,0,e,n)}skewY(t,e,n){return this.skew(0,t,e,n)}toArray(){return[this.a,this.b,this.c,this.d,this.e,this.f]}toString(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}transform(t){if(Matrix.isMatrixLike(t)){const e=new Matrix(t);return e.multiplyO(this)}const e=Matrix.formatTransforms(t);const n=this;const{x:i,y:r}=new Point(e.ox,e.oy).transform(n);const s=(new Matrix).translateO(e.rx,e.ry).lmultiplyO(n).translateO(-i,-r).scaleO(e.scaleX,e.scaleY).skewO(e.skewX,e.skewY).shearO(e.shear).rotateO(e.theta).translateO(i,r);if(isFinite(e.px)||isFinite(e.py)){const t=new Point(i,r).transform(s);const n=isFinite(e.px)?e.px-t.x:0;const o=isFinite(e.py)?e.py-t.y:0;s.translateO(n,o)}s.translateO(e.tx,e.ty);return s}translate(t,e){return this.clone().translateO(t,e)}translateO(t,e){this.e+=t||0;this.f+=e||0;return this}valueOf(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}}function ctm(){return new Matrix(this.node.getCTM())}function screenCTM(){if(typeof this.isRoot==="function"&&!this.isRoot()){const t=this.rect(1,1);const e=t.node.getScreenCTM();t.remove();return new Matrix(e)}return new Matrix(this.node.getScreenCTM())}register(Matrix,"Matrix");function parser(){if(!parser.nodes){const t=makeInstance().size(2,0);t.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";");t.attr("focusable","false");t.attr("aria-hidden","true");const e=t.path().node;parser.nodes={svg:t,path:e}}if(!parser.nodes.svg.node.parentNode){const t=d.document.body||d.document.documentElement;parser.nodes.svg.addTo(t)}return parser.nodes}function isNulledBox(t){return!t.width&&!t.height&&!t.x&&!t.y}function domContains(t){return t===d.document||(d.document.documentElement.contains||function(t){while(t.parentNode){t=t.parentNode}return t===d.document}).call(d.document.documentElement,t)}class Box{constructor(...t){this.init(...t)}addOffset(){this.x+=d.window.pageXOffset;this.y+=d.window.pageYOffset;return new Box(this)}init(t){const e=[0,0,0,0];t=typeof t==="string"?t.split(I).map(parseFloat):Array.isArray(t)?t:typeof t==="object"?[t.left!=null?t.left:t.x,t.top!=null?t.top:t.y,t.width,t.height]:arguments.length===4?[].slice.call(arguments):e;this.x=t[0]||0;this.y=t[1]||0;this.width=this.w=t[2]||0;this.height=this.h=t[3]||0;this.x2=this.x+this.w;this.y2=this.y+this.h;this.cx=this.x+this.w/2;this.cy=this.y+this.h/2;return this}isNulled(){return isNulledBox(this)}merge(t){const e=Math.min(this.x,t.x);const n=Math.min(this.y,t.y);const i=Math.max(this.x+this.width,t.x+t.width)-e;const r=Math.max(this.y+this.height,t.y+t.height)-n;return new Box(e,n,i,r)}toArray(){return[this.x,this.y,this.width,this.height]}toString(){return this.x+" "+this.y+" "+this.width+" "+this.height}transform(t){if(!(t instanceof Matrix)){t=new Matrix(t)}let e=Infinity;let n=-Infinity;let i=Infinity;let r=-Infinity;const s=[new Point(this.x,this.y),new Point(this.x2,this.y),new Point(this.x,this.y2),new Point(this.x2,this.y2)];s.forEach((function(s){s=s.transform(t);e=Math.min(e,s.x);n=Math.max(n,s.x);i=Math.min(i,s.y);r=Math.max(r,s.y)}));return new Box(e,i,n-e,r-i)}}function getBox(t,e,n){let i;try{i=e(t.node);if(isNulledBox(i)&&!domContains(t.node)){throw new Error("Element not in the dom")}}catch(e){i=n(t)}return i}function bbox(){const getBBox=t=>t.getBBox();const retry=t=>{try{const e=t.clone().addTo(parser().svg).show();const n=e.node.getBBox();e.remove();return n}catch(e){throw new Error(`Getting bbox of element "${t.node.nodeName}" is not possible: ${e.toString()}`)}};const t=getBox(this,getBBox,retry);const e=new Box(t);return e}function rbox(t){const getRBox=t=>t.getBoundingClientRect();const retry=t=>{throw new Error(`Getting rbox of element "${t.node.nodeName}" is not possible`)};const e=getBox(this,getRBox,retry);const n=new Box(e);if(t){return n.transform(t.screenCTM().inverseO())}return n.addOffset()}function inside(t,e){const n=this.bbox();return t>n.x&&e>n.y&&t<n.x+n.width&&e<n.y+n.height}registerMethods({viewbox:{viewbox(t,e,n,i){if(t==null)return new Box(this.attr("viewBox"));return this.attr("viewBox",new Box(t,e,n,i))},zoom(t,e){let{width:n,height:i}=this.attr(["width","height"]);if(!n&&!i||typeof n==="string"||typeof i==="string"){n=this.node.clientWidth;i=this.node.clientHeight}if(!n||!i){throw new Error("Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element")}const r=this.viewbox();const s=n/r.width;const o=i/r.height;const a=Math.min(s,o);if(t==null){return a}let h=a/t;if(h===Infinity)h=Number.MAX_SAFE_INTEGER/100;e=e||new Point(n/2/s+r.x,i/2/o+r.y);const l=new Box(r).transform(new Matrix({scale:h,origin:e}));return this.viewbox(l)}}});register(Box,"Box");class List extends Array{constructor(t=[],...e){super(t,...e);if(typeof t==="number")return this;this.length=0;this.push(...t)}}extend([List],{each(t,...e){if(typeof t==="function"){return this.map(((e,n,i)=>t.call(e,e,n,i)))}else{return this.map((n=>n[t](...e)))}},toArray(){return Array.prototype.concat.apply([],this)}});const B=["toArray","constructor","each"];List.extend=function(t){t=t.reduce(((t,e)=>{if(B.includes(e))return t;if(e[0]==="_")return t;t[e]=function(...t){return this.each(e,...t)};return t}),{});extend([List],t)};function baseFind(t,e){return new List(svg_esm_map((e||d.document).querySelectorAll(t),(function(t){return adopt(t)})))}function find(t){return baseFind(t,this.node)}function findOne(t){return adopt(this.node.querySelector(t))}let z=0;const j={};function getEvents(t){let e=t.getEventHolder();if(e===d.window)e=j;if(!e.events)e.events={};return e.events}function getEventTarget(t){return t.getEventTarget()}function clearEvents(t){let e=t.getEventHolder();if(e===d.window)e=j;if(e.events)e.events={}}function on(t,e,n,i,r){const s=n.bind(i||t);const o=makeInstance(t);const a=getEvents(o);const h=getEventTarget(o);e=Array.isArray(e)?e:e.split(I);if(!n._svgjsListenerId){n._svgjsListenerId=++z}e.forEach((function(t){const e=t.split(".")[0];const i=t.split(".")[1]||"*";a[e]=a[e]||{};a[e][i]=a[e][i]||{};a[e][i][n._svgjsListenerId]=s;h.addEventListener(e,s,r||false)}))}function off(t,e,n,i){const r=makeInstance(t);const s=getEvents(r);const o=getEventTarget(r);if(typeof n==="function"){n=n._svgjsListenerId;if(!n)return}e=Array.isArray(e)?e:(e||"").split(I);e.forEach((function(t){const e=t&&t.split(".")[0];const a=t&&t.split(".")[1];let h,l;if(n){if(s[e]&&s[e][a||"*"]){o.removeEventListener(e,s[e][a||"*"][n],i||false);delete s[e][a||"*"][n]}}else if(e&&a){if(s[e]&&s[e][a]){for(l in s[e][a]){off(o,[e,a].join("."),l)}delete s[e][a]}}else if(a){for(t in s){for(h in s[t]){if(a===h){off(o,[t,a].join("."))}}}}else if(e){if(s[e]){for(h in s[e]){off(o,[e,h].join("."))}delete s[e]}}else{for(t in s){off(o,t)}clearEvents(r)}}))}function dispatch(t,e,n,i){const r=getEventTarget(t);if(e instanceof d.window.Event){r.dispatchEvent(e)}else{e=new d.window.CustomEvent(e,{detail:n,cancelable:true,...i});r.dispatchEvent(e)}return e}class EventTarget extends Base{addEventListener(){}dispatch(t,e,n){return dispatch(this,t,e,n)}dispatchEvent(t){const e=this.getEventHolder().events;if(!e)return true;const n=e[t.type];for(const e in n){for(const i in n[e]){n[e][i](t)}}return!t.defaultPrevented}fire(t,e,n){this.dispatch(t,e,n);return this}getEventHolder(){return this}getEventTarget(){return this}off(t,e,n){off(this,t,e,n);return this}on(t,e,n,i){on(this,t,e,n,i);return this}removeEventListener(){}}register(EventTarget,"EventTarget");function noop(){}const F={duration:400,ease:">",delay:0};const R={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"};var V={__proto__:null,noop:noop,timeline:F,attrs:R};class SVGArray extends Array{constructor(...t){super(...t);this.init(...t)}clone(){return new this.constructor(this)}init(t){if(typeof t==="number")return this;this.length=0;this.push(...this.parse(t));return this}parse(t=[]){if(t instanceof Array)return t;return t.trim().split(I).map(parseFloat)}toArray(){return Array.prototype.concat.apply([],this)}toSet(){return new Set(this)}toString(){return this.join(" ")}valueOf(){const t=[];t.push(...this);return t}}class SVGNumber{constructor(...t){this.init(...t)}convert(t){return new SVGNumber(this.value,t)}divide(t){t=new SVGNumber(t);return new SVGNumber(this/t,this.unit||t.unit)}init(t,e){e=Array.isArray(t)?t[1]:e;t=Array.isArray(t)?t[0]:t;this.value=0;this.unit=e||"";if(typeof t==="number"){this.value=isNaN(t)?0:!isFinite(t)?t<0?-34e37:+34e37:t}else if(typeof t==="string"){e=t.match(v);if(e){this.value=parseFloat(e[1]);if(e[5]==="%"){this.value/=100}else if(e[5]==="s"){this.value*=1e3}this.unit=e[5]}}else{if(t instanceof SVGNumber){this.value=t.valueOf();this.unit=t.unit}}return this}minus(t){t=new SVGNumber(t);return new SVGNumber(this-t,this.unit||t.unit)}plus(t){t=new SVGNumber(t);return new SVGNumber(this+t,this.unit||t.unit)}times(t){t=new SVGNumber(t);return new SVGNumber(this*t,this.unit||t.unit)}toArray(){return[this.value,this.unit]}toJSON(){return this.toString()}toString(){return(this.unit==="%"?~~(this.value*1e8)/1e6:this.unit==="s"?this.value/1e3:this.value)+this.unit}valueOf(){return this.value}}const W=[];function registerAttrHook(t){W.push(t)}function attr(t,e,n){if(t==null){t={};e=this.node.attributes;for(const n of e){t[n.nodeName]=N.test(n.nodeValue)?parseFloat(n.nodeValue):n.nodeValue}return t}else if(t instanceof Array){return t.reduce(((t,e)=>{t[e]=this.attr(e);return t}),{})}else if(typeof t==="object"&&t.constructor===Object){for(e in t)this.attr(e,t[e])}else if(e===null){this.node.removeAttribute(t)}else if(e==null){e=this.node.getAttribute(t);return e==null?R[t]:N.test(e)?parseFloat(e):e}else{e=W.reduce(((e,n)=>n(t,e,this)),e);if(typeof e==="number"){e=new SVGNumber(e)}else if(Color.isColor(e)){e=new Color(e)}else if(e.constructor===Array){e=new SVGArray(e)}if(t==="leading"){if(this.leading){this.leading(e)}}else{typeof n==="string"?this.node.setAttributeNS(n,t,e.toString()):this.node.setAttribute(t,e.toString())}if(this.rebuild&&(t==="font-size"||t==="x")){this.rebuild()}}return this}class Dom extends EventTarget{constructor(t,e){super();this.node=t;this.type=t.nodeName;if(e&&t!==e){this.attr(e)}}add(t,e){t=makeInstance(t);if(t.removeNamespace&&this.node instanceof d.window.SVGElement){t.removeNamespace()}if(e==null){this.node.appendChild(t.node)}else if(t.node!==this.node.childNodes[e]){this.node.insertBefore(t.node,this.node.childNodes[e])}return this}addTo(t,e){return makeInstance(t).put(this,e)}children(){return new List(svg_esm_map(this.node.children,(function(t){return adopt(t)})))}clear(){while(this.node.hasChildNodes()){this.node.removeChild(this.node.lastChild)}return this}clone(t=true){this.writeDataToDom();return new this.constructor(assignNewId(this.node.cloneNode(t)))}each(t,e){const n=this.children();let i,r;for(i=0,r=n.length;i<r;i++){t.apply(n[i],[i,n]);if(e){n[i].each(t,e)}}return this}element(t,e){return this.put(new Dom(create(t),e))}first(){return adopt(this.node.firstChild)}get(t){return adopt(this.node.childNodes[t])}getEventHolder(){return this.node}getEventTarget(){return this.node}has(t){return this.index(t)>=0}html(t,e){return this.xml(t,e,a)}id(t){if(typeof t==="undefined"&&!this.node.id){this.node.id=eid(this.type)}return this.attr("id",t)}index(t){return[].slice.call(this.node.childNodes).indexOf(t.node)}last(){return adopt(this.node.lastChild)}matches(t){const e=this.node;const n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return n&&n.call(e,t)}parent(t){let e=this;if(!e.node.parentNode)return null;e=adopt(e.node.parentNode);if(!t)return e;do{if(typeof t==="string"?e.matches(t):e instanceof t)return e}while(e=adopt(e.node.parentNode));return e}put(t,e){t=makeInstance(t);this.add(t,e);return t}putIn(t,e){return makeInstance(t).add(this,e)}remove(){if(this.parent()){this.parent().removeElement(this)}return this}removeElement(t){this.node.removeChild(t.node);return this}replace(t){t=makeInstance(t);if(this.node.parentNode){this.node.parentNode.replaceChild(t.node,this.node)}return t}round(t=2,e=null){const n=10**t;const i=this.attr(e);for(const t in i){if(typeof i[t]==="number"){i[t]=Math.round(i[t]*n)/n}}this.attr(i);return this}svg(t,e){return this.xml(t,e,o)}toString(){return this.id()}words(t){this.node.textContent=t;return this}wrap(t){const e=this.parent();if(!e){return this.addTo(t)}const n=e.index(this);return e.put(t,n).put(this)}writeDataToDom(){this.each((function(){this.writeDataToDom()}));return this}xml(t,e,n){if(typeof t==="boolean"){n=e;e=t;t=null}if(t==null||typeof t==="function"){e=e==null?true:e;this.writeDataToDom();let n=this;if(t!=null){n=adopt(n.node.cloneNode(true));if(e){const e=t(n);n=e||n;if(e===false)return""}n.each((function(){const e=t(this);const n=e||this;if(e===false){this.remove()}else if(e&&this!==n){this.replace(n)}}),true)}return e?n.node.outerHTML:n.node.innerHTML}e=e==null?false:e;const i=create("wrapper",n);const r=d.document.createDocumentFragment();i.innerHTML=t;for(let t=i.children.length;t--;){r.appendChild(i.firstElementChild)}const s=this.parent();return e?this.replace(r)&&s:this.add(r)}}extend(Dom,{attr:attr,find:find,findOne:findOne});register(Dom,"Dom");class Element extends Dom{constructor(t,e){super(t,e);this.dom={};this.node.instance=this;if(t.hasAttribute("svgjs:data")){this.setData(JSON.parse(t.getAttribute("svgjs:data"))||{})}}center(t,e){return this.cx(t).cy(e)}cx(t){return t==null?this.x()+this.width()/2:this.x(t-this.width()/2)}cy(t){return t==null?this.y()+this.height()/2:this.y(t-this.height()/2)}defs(){const t=this.root();return t&&t.defs()}dmove(t,e){return this.dx(t).dy(e)}dx(t=0){return this.x(new SVGNumber(t).plus(this.x()))}dy(t=0){return this.y(new SVGNumber(t).plus(this.y()))}getEventHolder(){return this}height(t){return this.attr("height",t)}move(t,e){return this.x(t).y(e)}parents(t=this.root()){const e=typeof t==="string";if(!e){t=makeInstance(t)}const n=new List;let i=this;while((i=i.parent())&&i.node!==d.document&&i.nodeName!=="#document-fragment"){n.push(i);if(!e&&i.node===t.node){break}if(e&&i.matches(t)){break}if(i.node===this.root().node){return null}}return n}reference(t){t=this.attr(t);if(!t)return null;const e=(t+"").match(M);return e?makeInstance(e[1]):null}root(){const t=this.parent(getClass(g));return t&&t.root()}setData(t){this.dom=t;return this}size(t,e){const n=proportionalSize(this,t,e);return this.width(new SVGNumber(n.width)).height(new SVGNumber(n.height))}width(t){return this.attr("width",t)}writeDataToDom(){this.node.removeAttribute("svgjs:data");if(Object.keys(this.dom).length){this.node.setAttribute("svgjs:data",JSON.stringify(this.dom))}return super.writeDataToDom()}x(t){return this.attr("x",t)}y(t){return this.attr("y",t)}}extend(Element,{bbox:bbox,rbox:rbox,inside:inside,point:point,ctm:ctm,screenCTM:screenCTM});register(Element,"Element");const q={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(t,e){return e==="color"?t:t+"-"+e}};["fill","stroke"].forEach((function(t){const e={};let n;e[t]=function(e){if(typeof e==="undefined"){return this.attr(t)}if(typeof e==="string"||e instanceof Color||Color.isRgb(e)||e instanceof Element){this.attr(t,e)}else{for(n=q[t].length-1;n>=0;n--){if(e[q[t][n]]!=null){this.attr(q.prefix(t,q[t][n]),e[q[t][n]])}}}return this};registerMethods(["Element","Runner"],e)}));registerMethods(["Element","Runner"],{matrix:function(t,e,n,i,r,s){if(t==null){return new Matrix(this)}return this.attr("transform",new Matrix(t,e,n,i,r,s))},rotate:function(t,e,n){return this.transform({rotate:t,ox:e,oy:n},true)},skew:function(t,e,n,i){return arguments.length===1||arguments.length===3?this.transform({skew:t,ox:e,oy:n},true):this.transform({skew:[t,e],ox:n,oy:i},true)},shear:function(t,e,n){return this.transform({shear:t,ox:e,oy:n},true)},scale:function(t,e,n,i){return arguments.length===1||arguments.length===3?this.transform({scale:t,ox:e,oy:n},true):this.transform({scale:[t,e],ox:n,oy:i},true)},translate:function(t,e){return this.transform({translate:[t,e]},true)},relative:function(t,e){return this.transform({relative:[t,e]},true)},flip:function(t="both",e="center"){if("xybothtrue".indexOf(t)===-1){e=t;t="both"}return this.transform({flip:t,origin:e},true)},opacity:function(t){return this.attr("opacity",t)}});registerMethods("radius",{radius:function(t,e=t){const n=(this._element||this).type;return n==="radialGradient"?this.attr("r",new SVGNumber(t)):this.rx(t).ry(e)}});registerMethods("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(t){return new Point(this.node.getPointAtLength(t))}});registerMethods(["Element","Runner"],{font:function(t,e){if(typeof t==="object"){for(e in t)this.font(e,t[e]);return this}return t==="leading"?this.leading(e):t==="anchor"?this.attr("text-anchor",e):t==="size"||t==="family"||t==="weight"||t==="stretch"||t==="variant"||t==="style"?this.attr("font-"+t,e):this.attr(t,e)}});const U=["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].reduce((function(t,e){const fn=function(t){if(t===null){this.off(e)}else{this.on(e,t)}return this};t[e]=fn;return t}),{});registerMethods("Element",U);function untransform(){return this.attr("transform",null)}function matrixify(){const t=(this.attr("transform")||"").split(S).slice(0,-1).map((function(t){const e=t.trim().split("(");return[e[0],e[1].split(I).map((function(t){return parseFloat(t)}))]})).reverse().reduce((function(t,e){if(e[0]==="matrix"){return t.lmultiply(Matrix.fromArray(e[1]))}return t[e[0]].apply(t,e[1])}),new Matrix);return t}function toParent(t,e){if(this===t)return this;const n=this.screenCTM();const i=t.screenCTM().inverse();this.addTo(t,e).untransform().transform(i.multiply(n));return this}function toRoot(t){return this.toParent(this.root(),t)}function transform(t,e){if(t==null||typeof t==="string"){const e=new Matrix(this).decompose();return t==null?e:e[t]}if(!Matrix.isMatrixLike(t)){t={...t,origin:getOrigin(t,this)}}const n=e===true?this:e||false;const i=new Matrix(n).transform(t);return this.attr("transform",i)}registerMethods("Element",{untransform:untransform,matrixify:matrixify,toParent:toParent,toRoot:toRoot,transform:transform});class Container extends Element{flatten(t=this,e){this.each((function(){if(this instanceof Container){return this.flatten().ungroup()}}));return this}ungroup(t=this.parent(),e=t.index(this)){e=e===-1?t.children().length:e;this.each((function(n,i){return i[i.length-n-1].toParent(t,e)}));return this.remove()}}register(Container,"Container");class Defs extends Container{constructor(t,e=t){super(nodeOrNew("defs",t),e)}flatten(){return this}ungroup(){return this}}register(Defs,"Defs");class Shape extends Element{}register(Shape,"Shape");function rx(t){return this.attr("rx",t)}function ry(t){return this.attr("ry",t)}function x$3(t){return t==null?this.cx()-this.rx():this.cx(t+this.rx())}function y$3(t){return t==null?this.cy()-this.ry():this.cy(t+this.ry())}function cx$1(t){return this.attr("cx",t)}function cy$1(t){return this.attr("cy",t)}function width$2(t){return t==null?this.rx()*2:this.rx(new SVGNumber(t).divide(2))}function height$2(t){return t==null?this.ry()*2:this.ry(new SVGNumber(t).divide(2))}var H={__proto__:null,rx:rx,ry:ry,x:x$3,y:y$3,cx:cx$1,cy:cy$1,width:width$2,height:height$2};class Ellipse extends Shape{constructor(t,e=t){super(nodeOrNew("ellipse",t),e)}size(t,e){const n=proportionalSize(this,t,e);return this.rx(new SVGNumber(n.width).divide(2)).ry(new SVGNumber(n.height).divide(2))}}extend(Ellipse,H);registerMethods("Container",{ellipse:wrapWithAttrCheck((function(t=0,e=t){return this.put(new Ellipse).size(t,e).move(0,0)}))});register(Ellipse,"Ellipse");class Fragment extends Dom{constructor(t=d.document.createDocumentFragment()){super(t)}xml(t,e,n){if(typeof t==="boolean"){n=e;e=t;t=null}if(t==null||typeof t==="function"){const t=new Dom(create("wrapper",n));t.add(this.node.cloneNode(true));return t.xml(false,n)}return super.xml(t,false,n)}}register(Fragment,"Fragment");function from(t,e){return(this._element||this).type==="radialGradient"?this.attr({fx:new SVGNumber(t),fy:new SVGNumber(e)}):this.attr({x1:new SVGNumber(t),y1:new SVGNumber(e)})}function to(t,e){return(this._element||this).type==="radialGradient"?this.attr({cx:new SVGNumber(t),cy:new SVGNumber(e)}):this.attr({x2:new SVGNumber(t),y2:new SVGNumber(e)})}var X={__proto__:null,from:from,to:to};class Gradient extends Container{constructor(t,e){super(nodeOrNew(t+"Gradient",typeof t==="string"?null:t),e)}attr(t,e,n){if(t==="transform")t="gradientTransform";return super.attr(t,e,n)}bbox(){return new Box}targets(){return baseFind('svg [fill*="'+this.id()+'"]')}toString(){return this.url()}update(t){this.clear();if(typeof t==="function"){t.call(this,this)}return this}url(){return'url("#'+this.id()+'")'}}extend(Gradient,X);registerMethods({Container:{gradient(...t){return this.defs().gradient(...t)}},Defs:{gradient:wrapWithAttrCheck((function(t,e){return this.put(new Gradient(t)).update(e)}))}});register(Gradient,"Gradient");class Pattern extends Container{constructor(t,e=t){super(nodeOrNew("pattern",t),e)}attr(t,e,n){if(t==="transform")t="patternTransform";return super.attr(t,e,n)}bbox(){return new Box}targets(){return baseFind('svg [fill*="'+this.id()+'"]')}toString(){return this.url()}update(t){this.clear();if(typeof t==="function"){t.call(this,this)}return this}url(){return'url("#'+this.id()+'")'}}registerMethods({Container:{pattern(...t){return this.defs().pattern(...t)}},Defs:{pattern:wrapWithAttrCheck((function(t,e,n){return this.put(new Pattern).update(n).attr({x:0,y:0,width:t,height:e,patternUnits:"userSpaceOnUse"})}))}});register(Pattern,"Pattern");class Image extends Shape{constructor(t,e=t){super(nodeOrNew("image",t),e)}load(t,e){if(!t)return this;const n=new d.window.Image;on(n,"load",(function(t){const i=this.parent(Pattern);if(this.width()===0&&this.height()===0){this.size(n.width,n.height)}if(i instanceof Pattern){if(i.width()===0&&i.height()===0){i.size(this.width(),this.height())}}if(typeof e==="function"){e.call(this,t)}}),this);on(n,"load error",(function(){off(n)}));return this.attr("href",n.src=t,l)}}registerAttrHook((function(t,e,n){if(t==="fill"||t==="stroke"){if(E.test(e)){e=n.root().defs().image(e)}}if(e instanceof Image){e=n.root().defs().pattern(0,0,(t=>{t.add(e)}))}return e}));registerMethods({Container:{image:wrapWithAttrCheck((function(t,e){return this.put(new Image).size(0,0).load(t,e)}))}});register(Image,"Image");class PointArray extends SVGArray{bbox(){let t=-Infinity;let e=-Infinity;let n=Infinity;let i=Infinity;this.forEach((function(r){t=Math.max(r[0],t);e=Math.max(r[1],e);n=Math.min(r[0],n);i=Math.min(r[1],i)}));return new Box(n,i,t-n,e-i)}move(t,e){const n=this.bbox();t-=n.x;e-=n.y;if(!isNaN(t)&&!isNaN(e)){for(let n=this.length-1;n>=0;n--){this[n]=[this[n][0]+t,this[n][1]+e]}}return this}parse(t=[0,0]){const e=[];if(t instanceof Array){t=Array.prototype.concat.apply([],t)}else{t=t.trim().split(I).map(parseFloat)}if(t.length%2!==0)t.pop();for(let n=0,i=t.length;n<i;n=n+2){e.push([t[n],t[n+1]])}return e}size(t,e){let n;const i=this.bbox();for(n=this.length-1;n>=0;n--){if(i.width)this[n][0]=(this[n][0]-i.x)*t/i.width+i.x;if(i.height)this[n][1]=(this[n][1]-i.y)*e/i.height+i.y}return this}toLine(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}}toString(){const t=[];for(let e=0,n=this.length;e<n;e++){t.push(this[e].join(","))}return t.join(" ")}transform(t){return this.clone().transformO(t)}transformO(t){if(!Matrix.isMatrixLike(t)){t=new Matrix(t)}for(let e=this.length;e--;){const[n,i]=this[e];this[e][0]=t.a*n+t.c*i+t.e;this[e][1]=t.b*n+t.d*i+t.f}return this}}const Y=PointArray;function x$2(t){return t==null?this.bbox().x:this.move(t,this.bbox().y)}function y$2(t){return t==null?this.bbox().y:this.move(this.bbox().x,t)}function width$1(t){const e=this.bbox();return t==null?e.width:this.size(t,e.height)}function height$1(t){const e=this.bbox();return t==null?e.height:this.size(e.width,t)}var J={__proto__:null,MorphArray:Y,x:x$2,y:y$2,width:width$1,height:height$1};class Line extends Shape{constructor(t,e=t){super(nodeOrNew("line",t),e)}array(){return new PointArray([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}move(t,e){return this.attr(this.array().move(t,e).toLine())}plot(t,e,n,i){if(t==null){return this.array()}else if(typeof e!=="undefined"){t={x1:t,y1:e,x2:n,y2:i}}else{t=new PointArray(t).toLine()}return this.attr(t)}size(t,e){const n=proportionalSize(this,t,e);return this.attr(this.array().size(n.width,n.height).toLine())}}extend(Line,J);registerMethods({Container:{line:wrapWithAttrCheck((function(...t){return Line.prototype.plot.apply(this.put(new Line),t[0]!=null?t:[0,0,0,0])}))}});register(Line,"Line");class Marker extends Container{constructor(t,e=t){super(nodeOrNew("marker",t),e)}height(t){return this.attr("markerHeight",t)}orient(t){return this.attr("orient",t)}ref(t,e){return this.attr("refX",t).attr("refY",e)}toString(){return"url(#"+this.id()+")"}update(t){this.clear();if(typeof t==="function"){t.call(this,this)}return this}width(t){return this.attr("markerWidth",t)}}registerMethods({Container:{marker(...t){return this.defs().marker(...t)}},Defs:{marker:wrapWithAttrCheck((function(t,e,n){return this.put(new Marker).size(t,e).ref(t/2,e/2).viewbox(0,0,t,e).attr("orient","auto").update(n)}))},marker:{marker(t,e,n,i){let r=["marker"];if(t!=="all")r.push(t);r=r.join("-");t=arguments[1]instanceof Marker?arguments[1]:this.defs().marker(e,n,i);return this.attr(r,t)}}});register(Marker,"Marker");function makeSetterGetter(t,e){return function(n){if(n==null)return this[t];this[t]=n;if(e)e.call(this);return this}}const Q={"-":function(t){return t},"<>":function(t){return-Math.cos(t*Math.PI)/2+.5},">":function(t){return Math.sin(t*Math.PI/2)},"<":function(t){return-Math.cos(t*Math.PI/2)+1},bezier:function(t,e,n,i){return function(r){if(r<0){if(t>0){return e/t*r}else if(n>0){return i/n*r}else{return 0}}else if(r>1){if(n<1){return(1-i)/(1-n)*r+(i-n)/(1-n)}else if(t<1){return(1-e)/(1-t)*r+(e-t)/(1-t)}else{return 1}}else{return 3*r*(1-r)**2*e+3*r**2*(1-r)*i+r**3}}},steps:function(t,e="end"){e=e.split("-").reverse()[0];let n=t;if(e==="none"){--n}else if(e==="both"){++n}return(i,r=false)=>{let s=Math.floor(i*t);const o=i*s%1===0;if(e==="start"||e==="both"){++s}if(r&&o){--s}if(i>=0&&s<0){s=0}if(i<=1&&s>n){s=n}return s/n}}};class Stepper{done(){return false}}class Ease extends Stepper{constructor(t=F.ease){super();this.ease=Q[t]||t}step(t,e,n){if(typeof t!=="number"){return n<1?t:e}return t+(e-t)*this.ease(n)}}class Controller extends Stepper{constructor(t){super();this.stepper=t}done(t){return t.done}step(t,e,n,i){return this.stepper(t,e,n,i)}}function recalculate(){const t=(this._duration||500)/1e3;const e=this._overshoot||0;const n=1e-10;const i=Math.PI;const r=Math.log(e/100+n);const s=-r/Math.sqrt(i*i+r*r);const o=3.9/(s*t);this.d=2*s*o;this.k=o*o}class Spring extends Controller{constructor(t=500,e=0){super();this.duration(t).overshoot(e)}step(t,e,n,i){if(typeof t==="string")return t;i.done=n===Infinity;if(n===Infinity)return e;if(n===0)return t;if(n>100)n=16;n/=1e3;const r=i.velocity||0;const s=-this.d*r-this.k*(t-e);const o=t+r*n+s*n*n/2;i.velocity=r+s*n;i.done=Math.abs(e-o)+Math.abs(r)<.002;return i.done?e:o}}extend(Spring,{duration:makeSetterGetter("_duration",recalculate),overshoot:makeSetterGetter("_overshoot",recalculate)});class PID extends Controller{constructor(t=.1,e=.01,n=0,i=1e3){super();this.p(t).i(e).d(n).windup(i)}step(t,e,n,i){if(typeof t==="string")return t;i.done=n===Infinity;if(n===Infinity)return e;if(n===0)return t;const r=e-t;let s=(i.integral||0)+r*n;const o=(r-(i.error||0))/n;const a=this._windup;if(a!==false){s=Math.max(-a,Math.min(s,a))}i.error=r;i.integral=s;i.done=Math.abs(r)<.001;return i.done?e:t+(this.P*r+this.I*s+this.D*o)}}extend(PID,{windup:makeSetterGetter("_windup"),p:makeSetterGetter("P"),i:makeSetterGetter("I"),d:makeSetterGetter("D")});const Z={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0};const K={M:function(t,e,n){e.x=n.x=t[0];e.y=n.y=t[1];return["M",e.x,e.y]},L:function(t,e){e.x=t[0];e.y=t[1];return["L",t[0],t[1]]},H:function(t,e){e.x=t[0];return["H",t[0]]},V:function(t,e){e.y=t[0];return["V",t[0]]},C:function(t,e){e.x=t[4];e.y=t[5];return["C",t[0],t[1],t[2],t[3],t[4],t[5]]},S:function(t,e){e.x=t[2];e.y=t[3];return["S",t[0],t[1],t[2],t[3]]},Q:function(t,e){e.x=t[2];e.y=t[3];return["Q",t[0],t[1],t[2],t[3]]},T:function(t,e){e.x=t[0];e.y=t[1];return["T",t[0],t[1]]},Z:function(t,e,n){e.x=n.x;e.y=n.y;return["Z"]},A:function(t,e){e.x=t[5];e.y=t[6];return["A",t[0],t[1],t[2],t[3],t[4],t[5],t[6]]}};const tt="mlhvqtcsaz".split("");for(let t=0,e=tt.length;t<e;++t){K[tt[t]]=function(t){return function(e,n,i){if(t==="H")e[0]=e[0]+n.x;else if(t==="V")e[0]=e[0]+n.y;else if(t==="A"){e[5]=e[5]+n.x;e[6]=e[6]+n.y}else{for(let t=0,i=e.length;t<i;++t){e[t]=e[t]+(t%2?n.y:n.x)}}return K[t](e,n,i)}}(tt[t].toUpperCase())}function makeAbsolut(t){const e=t.segment[0];return K[e](t.segment.slice(1),t.p,t.p0)}function segmentComplete(t){return t.segment.length&&t.segment.length-1===Z[t.segment[0].toUpperCase()]}function startNewSegment(t,e){t.inNumber&&finalizeNumber(t,false);const n=D.test(e);if(n){t.segment=[e]}else{const e=t.lastCommand;const n=e.toLowerCase();const i=e===n;t.segment=[n==="m"?i?"l":"L":e]}t.inSegment=true;t.lastCommand=t.segment[0];return n}function finalizeNumber(t,e){if(!t.inNumber)throw new Error("Parser Error");t.number&&t.segment.push(parseFloat(t.number));t.inNumber=e;t.number="";t.pointSeen=false;t.hasExponent=false;if(segmentComplete(t)){finalizeSegment(t)}}function finalizeSegment(t){t.inSegment=false;if(t.absolute){t.segment=makeAbsolut(t)}t.segments.push(t.segment)}function isArcFlag(t){if(!t.segment.length)return false;const e=t.segment[0].toUpperCase()==="A";const n=t.segment.length;return e&&(n===4||n===5)}function isExponential(t){return t.lastToken.toUpperCase()==="E"}function pathParser(t,e=true){let n=0;let i="";const r={segment:[],inNumber:false,number:"",lastToken:"",inSegment:false,segments:[],pointSeen:false,hasExponent:false,absolute:e,p0:new Point,p:new Point};while(r.lastToken=i,i=t.charAt(n++)){if(!r.inSegment){if(startNewSegment(r,i)){continue}}if(i==="."){if(r.pointSeen||r.hasExponent){finalizeNumber(r,false);--n;continue}r.inNumber=true;r.pointSeen=true;r.number+=i;continue}if(!isNaN(parseInt(i))){if(r.number==="0"||isArcFlag(r)){r.inNumber=true;r.number=i;finalizeNumber(r,true);continue}r.inNumber=true;r.number+=i;continue}if(i===" "||i===","){if(r.inNumber){finalizeNumber(r,false)}continue}if(i==="-"){if(r.inNumber&&!isExponential(r)){finalizeNumber(r,false);--n;continue}r.number+=i;r.inNumber=true;continue}if(i.toUpperCase()==="E"){r.number+=i;r.hasExponent=true;continue}if(D.test(i)){if(r.inNumber){finalizeNumber(r,false)}else if(!segmentComplete(r)){throw new Error("parser Error")}else{finalizeSegment(r)}--n}}if(r.inNumber){finalizeNumber(r,false)}if(r.inSegment&&segmentComplete(r)){finalizeSegment(r)}return r.segments}function arrayToString(t){let e="";for(let n=0,i=t.length;n<i;n++){e+=t[n][0];if(t[n][1]!=null){e+=t[n][1];if(t[n][2]!=null){e+=" ";e+=t[n][2];if(t[n][3]!=null){e+=" ";e+=t[n][3];e+=" ";e+=t[n][4];if(t[n][5]!=null){e+=" ";e+=t[n][5];e+=" ";e+=t[n][6];if(t[n][7]!=null){e+=" ";e+=t[n][7]}}}}}}return e+" "}class PathArray extends SVGArray{bbox(){parser().path.setAttribute("d",this.toString());return new Box(parser.nodes.path.getBBox())}move(t,e){const n=this.bbox();t-=n.x;e-=n.y;if(!isNaN(t)&&!isNaN(e)){for(let n,i=this.length-1;i>=0;i--){n=this[i][0];if(n==="M"||n==="L"||n==="T"){this[i][1]+=t;this[i][2]+=e}else if(n==="H"){this[i][1]+=t}else if(n==="V"){this[i][1]+=e}else if(n==="C"||n==="S"||n==="Q"){this[i][1]+=t;this[i][2]+=e;this[i][3]+=t;this[i][4]+=e;if(n==="C"){this[i][5]+=t;this[i][6]+=e}}else if(n==="A"){this[i][6]+=t;this[i][7]+=e}}}return this}parse(t="M0 0"){if(Array.isArray(t)){t=Array.prototype.concat.apply([],t).toString()}return pathParser(t)}size(t,e){const n=this.bbox();let i,r;n.width=n.width===0?1:n.width;n.height=n.height===0?1:n.height;for(i=this.length-1;i>=0;i--){r=this[i][0];if(r==="M"||r==="L"||r==="T"){this[i][1]=(this[i][1]-n.x)*t/n.width+n.x;this[i][2]=(this[i][2]-n.y)*e/n.height+n.y}else if(r==="H"){this[i][1]=(this[i][1]-n.x)*t/n.width+n.x}else if(r==="V"){this[i][1]=(this[i][1]-n.y)*e/n.height+n.y}else if(r==="C"||r==="S"||r==="Q"){this[i][1]=(this[i][1]-n.x)*t/n.width+n.x;this[i][2]=(this[i][2]-n.y)*e/n.height+n.y;this[i][3]=(this[i][3]-n.x)*t/n.width+n.x;this[i][4]=(this[i][4]-n.y)*e/n.height+n.y;if(r==="C"){this[i][5]=(this[i][5]-n.x)*t/n.width+n.x;this[i][6]=(this[i][6]-n.y)*e/n.height+n.y}}else if(r==="A"){this[i][1]=this[i][1]*t/n.width;this[i][2]=this[i][2]*e/n.height;this[i][6]=(this[i][6]-n.x)*t/n.width+n.x;this[i][7]=(this[i][7]-n.y)*e/n.height+n.y}}return this}toString(){return arrayToString(this)}}const getClassForType=t=>{const e=typeof t;if(e==="number"){return SVGNumber}else if(e==="string"){if(Color.isColor(t)){return Color}else if(I.test(t)){return D.test(t)?PathArray:SVGArray}else if(v.test(t)){return SVGNumber}else{return NonMorphable}}else if(et.indexOf(t.constructor)>-1){return t.constructor}else if(Array.isArray(t)){return SVGArray}else if(e==="object"){return ObjectBag}else{return NonMorphable}};class Morphable{constructor(t){this._stepper=t||new Ease("-");this._from=null;this._to=null;this._type=null;this._context=null;this._morphObj=null}at(t){return this._morphObj.morph(this._from,this._to,t,this._stepper,this._context)}done(){const t=this._context.map(this._stepper.done).reduce((function(t,e){return t&&e}),true);return t}from(t){if(t==null){return this._from}this._from=this._set(t);return this}stepper(t){if(t==null)return this._stepper;this._stepper=t;return this}to(t){if(t==null){return this._to}this._to=this._set(t);return this}type(t){if(t==null){return this._type}this._type=t;return this}_set(t){if(!this._type){this.type(getClassForType(t))}let e=new this._type(t);if(this._type===Color){e=this._to?e[this._to[4]]():this._from?e[this._from[4]]():e}if(this._type===ObjectBag){e=this._to?e.align(this._to):this._from?e.align(this._from):e}e=e.toConsumable();this._morphObj=this._morphObj||new this._type;this._context=this._context||Array.apply(null,Array(e.length)).map(Object).map((function(t){t.done=true;return t}));return e}}class NonMorphable{constructor(...t){this.init(...t)}init(t){t=Array.isArray(t)?t[0]:t;this.value=t;return this}toArray(){return[this.value]}valueOf(){return this.value}}class TransformBag{constructor(...t){this.init(...t)}init(t){if(Array.isArray(t)){t={scaleX:t[0],scaleY:t[1],shear:t[2],rotate:t[3],translateX:t[4],translateY:t[5],originX:t[6],originY:t[7]}}Object.assign(this,TransformBag.defaults,t);return this}toArray(){const t=this;return[t.scaleX,t.scaleY,t.shear,t.rotate,t.translateX,t.translateY,t.originX,t.originY]}}TransformBag.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0};const sortByKey=(t,e)=>t[0]<e[0]?-1:t[0]>e[0]?1:0;class ObjectBag{constructor(...t){this.init(...t)}align(t){const e=this.values;for(let n=0,i=e.length;n<i;++n){if(e[n+1]===t[n+1]){if(e[n+1]===Color&&t[n+7]!==e[n+7]){const e=t[n+7];const i=new Color(this.values.splice(n+3,5))[e]().toArray();this.values.splice(n+3,0,...i)}n+=e[n+2]+2;continue}if(!t[n+1]){return this}const i=(new t[n+1]).toArray();const r=e[n+2]+3;e.splice(n,r,t[n],t[n+1],t[n+2],...i);n+=e[n+2]+2}return this}init(t){this.values=[];if(Array.isArray(t)){this.values=t.slice();return}t=t||{};const e=[];for(const n in t){const i=getClassForType(t[n]);const r=new i(t[n]).toArray();e.push([n,i,r.length,...r])}e.sort(sortByKey);this.values=e.reduce(((t,e)=>t.concat(e)),[]);return this}toArray(){return this.values}valueOf(){const t={};const e=this.values;while(e.length){const n=e.shift();const i=e.shift();const r=e.shift();const s=e.splice(0,r);t[n]=new i(s)}return t}}const et=[NonMorphable,TransformBag,ObjectBag];function registerMorphableType(t=[]){et.push(...[].concat(t))}function makeMorphable(){extend(et,{to(t){return(new Morphable).type(this.constructor).from(this.toArray()).to(t)},fromArray(t){this.init(t);return this},toConsumable(){return this.toArray()},morph(t,e,n,i,r){const mapper=function(t,s){return i.step(t,e[s],n,r[s],r)};return this.fromArray(t.map(mapper))}})}class Path extends Shape{constructor(t,e=t){super(nodeOrNew("path",t),e)}array(){return this._array||(this._array=new PathArray(this.attr("d")))}clear(){delete this._array;return this}height(t){return t==null?this.bbox().height:this.size(this.bbox().width,t)}move(t,e){return this.attr("d",this.array().move(t,e))}plot(t){return t==null?this.array():this.clear().attr("d",typeof t==="string"?t:this._array=new PathArray(t))}size(t,e){const n=proportionalSize(this,t,e);return this.attr("d",this.array().size(n.width,n.height))}width(t){return t==null?this.bbox().width:this.size(t,this.bbox().height)}x(t){return t==null?this.bbox().x:this.move(t,this.bbox().y)}y(t){return t==null?this.bbox().y:this.move(this.bbox().x,t)}}Path.prototype.MorphArray=PathArray;registerMethods({Container:{path:wrapWithAttrCheck((function(t){return this.put(new Path).plot(t||new PathArray)}))}});register(Path,"Path");function array(){return this._array||(this._array=new PointArray(this.attr("points")))}function clear(){delete this._array;return this}function move$2(t,e){return this.attr("points",this.array().move(t,e))}function plot(t){return t==null?this.array():this.clear().attr("points",typeof t==="string"?t:this._array=new PointArray(t))}function size$1(t,e){const n=proportionalSize(this,t,e);return this.attr("points",this.array().size(n.width,n.height))}var nt={__proto__:null,array:array,clear:clear,move:move$2,plot:plot,size:size$1};class Polygon extends Shape{constructor(t,e=t){super(nodeOrNew("polygon",t),e)}}registerMethods({Container:{polygon:wrapWithAttrCheck((function(t){return this.put(new Polygon).plot(t||new PointArray)}))}});extend(Polygon,J);extend(Polygon,nt);register(Polygon,"Polygon");class Polyline extends Shape{constructor(t,e=t){super(nodeOrNew("polyline",t),e)}}registerMethods({Container:{polyline:wrapWithAttrCheck((function(t){return this.put(new Polyline).plot(t||new PointArray)}))}});extend(Polyline,J);extend(Polyline,nt);register(Polyline,"Polyline");class Rect extends Shape{constructor(t,e=t){super(nodeOrNew("rect",t),e)}}extend(Rect,{rx:rx,ry:ry});registerMethods({Container:{rect:wrapWithAttrCheck((function(t,e){return this.put(new Rect).size(t,e)}))}});register(Rect,"Rect");class Queue{constructor(){this._first=null;this._last=null}first(){return this._first&&this._first.value}last(){return this._last&&this._last.value}push(t){const e=typeof t.next!=="undefined"?t:{value:t,next:null,prev:null};if(this._last){e.prev=this._last;this._last.next=e;this._last=e}else{this._last=e;this._first=e}return e}remove(t){if(t.prev)t.prev.next=t.next;if(t.next)t.next.prev=t.prev;if(t===this._last)this._last=t.prev;if(t===this._first)this._first=t.next;t.prev=null;t.next=null}shift(){const t=this._first;if(!t)return null;this._first=t.next;if(this._first)this._first.prev=null;this._last=this._first?this._last:null;return t.value}}const it={nextDraw:null,frames:new Queue,timeouts:new Queue,immediates:new Queue,timer:()=>d.window.performance||d.window.Date,transforms:[],frame(t){const e=it.frames.push({run:t});if(it.nextDraw===null){it.nextDraw=d.window.requestAnimationFrame(it._draw)}return e},timeout(t,e){e=e||0;const n=it.timer().now()+e;const i=it.timeouts.push({run:t,time:n});if(it.nextDraw===null){it.nextDraw=d.window.requestAnimationFrame(it._draw)}return i},immediate(t){const e=it.immediates.push(t);if(it.nextDraw===null){it.nextDraw=d.window.requestAnimationFrame(it._draw)}return e},cancelFrame(t){t!=null&&it.frames.remove(t)},clearTimeout(t){t!=null&&it.timeouts.remove(t)},cancelImmediate(t){t!=null&&it.immediates.remove(t)},_draw(t){let e=null;const n=it.timeouts.last();while(e=it.timeouts.shift()){if(t>=e.time){e.run()}else{it.timeouts.push(e)}if(e===n)break}let i=null;const r=it.frames.last();while(i!==r&&(i=it.frames.shift())){i.run(t)}let s=null;while(s=it.immediates.shift()){s()}it.nextDraw=it.timeouts.first()||it.frames.first()?d.window.requestAnimationFrame(it._draw):null}};const makeSchedule=function(t){const e=t.start;const n=t.runner.duration();const i=e+n;return{start:e,duration:n,end:i,runner:t.runner}};const defaultSource=function(){const t=d.window;return(t.performance||t.Date).now()};class Timeline extends EventTarget{constructor(t=defaultSource){super();this._timeSource=t;this._startTime=0;this._speed=1;this._persist=0;this._nextFrame=null;this._paused=true;this._runners=[];this._runnerIds=[];this._lastRunnerId=-1;this._time=0;this._lastSourceTime=0;this._lastStepTime=0;this._step=this._stepFn.bind(this,false);this._stepImmediate=this._stepFn.bind(this,true)}active(){return!!this._nextFrame}finish(){this.time(this.getEndTimeOfTimeline()+1);return this.pause()}getEndTime(){const t=this.getLastRunnerInfo();const e=t?t.runner.duration():0;const n=t?t.start:this._time;return n+e}getEndTimeOfTimeline(){const t=this._runners.map((t=>t.start+t.runner.duration()));return Math.max(0,...t)}getLastRunnerInfo(){return this.getRunnerInfoById(this._lastRunnerId)}getRunnerInfoById(t){return this._runners[this._runnerIds.indexOf(t)]||null}pause(){this._paused=true;return this._continue()}persist(t){if(t==null)return this._persist;this._persist=t;return this}play(){this._paused=false;return this.updateTime()._continue()}reverse(t){const e=this.speed();if(t==null)return this.speed(-e);const n=Math.abs(e);return this.speed(t?-n:n)}schedule(t,e,n){if(t==null){return this._runners.map(makeSchedule)}let i=0;const r=this.getEndTime();e=e||0;if(n==null||n==="last"||n==="after"){i=r}else if(n==="absolute"||n==="start"){i=e;e=0}else if(n==="now"){i=this._time}else if(n==="relative"){const n=this.getRunnerInfoById(t.id);if(n){i=n.start+e;e=0}}else if(n==="with-last"){const t=this.getLastRunnerInfo();const e=t?t.start:this._time;i=e}else{throw new Error('Invalid value for the "when" parameter')}t.unschedule();t.timeline(this);const s=t.persist();const o={persist:s===null?this._persist:s,start:i+e,runner:t};this._lastRunnerId=t.id;this._runners.push(o);this._runners.sort(((t,e)=>t.start-e.start));this._runnerIds=this._runners.map((t=>t.runner.id));this.updateTime()._continue();return this}seek(t){return this.time(this._time+t)}source(t){if(t==null)return this._timeSource;this._timeSource=t;return this}speed(t){if(t==null)return this._speed;this._speed=t;return this}stop(){this.time(0);return this.pause()}time(t){if(t==null)return this._time;this._time=t;return this._continue(true)}unschedule(t){const e=this._runnerIds.indexOf(t.id);if(e<0)return this;this._runners.splice(e,1);this._runnerIds.splice(e,1);t.timeline(null);return this}updateTime(){if(!this.active()){this._lastSourceTime=this._timeSource()}return this}_continue(t=false){it.cancelFrame(this._nextFrame);this._nextFrame=null;if(t)return this._stepImmediate();if(this._paused)return this;this._nextFrame=it.frame(this._step);return this}_stepFn(t=false){const e=this._timeSource();let n=e-this._lastSourceTime;if(t)n=0;const i=this._speed*n+(this._time-this._lastStepTime);this._lastSourceTime=e;if(!t){this._time+=i;this._time=this._time<0?0:this._time}this._lastStepTime=this._time;this.fire("time",this._time);for(let t=this._runners.length;t--;){const e=this._runners[t];const n=e.runner;const i=this._time-e.start;if(i<=0){n.reset()}}let r=false;for(let t=0,e=this._runners.length;t<e;t++){const n=this._runners[t];const s=n.runner;let o=i;const a=this._time-n.start;if(a<=0){r=true;continue}else if(a<o){o=a}if(!s.active())continue;const h=s.step(o).done;if(!h){r=true}else if(n.persist!==true){const i=s.duration()-s.time()+this._time;if(i+n.persist<this._time){s.unschedule();--t;--e}}}if(r&&!(this._speed<0&&this._time===0)||this._runnerIds.length&&this._speed<0&&this._time>0){this._continue()}else{this.pause();this.fire("finished")}return this}}registerMethods({Element:{timeline:function(t){if(t==null){this._timeline=this._timeline||new Timeline;return this._timeline}else{this._timeline=t;return this}}}});class Runner extends EventTarget{constructor(t){super();this.id=Runner.id++;t=t==null?F.duration:t;t=typeof t==="function"?new Controller(t):t;this._element=null;this._timeline=null;this.done=false;this._queue=[];this._duration=typeof t==="number"&&t;this._isDeclarative=t instanceof Controller;this._stepper=this._isDeclarative?t:new Ease;this._history={};this.enabled=true;this._time=0;this._lastTime=0;this._reseted=true;this.transforms=new Matrix;this.transformId=1;this._haveReversed=false;this._reverse=false;this._loopsDone=0;this._swing=false;this._wait=0;this._times=1;this._frameId=null;this._persist=this._isDeclarative?true:null}static sanitise(t,e,n){let i=1;let r=false;let s=0;t=t||F.duration;e=e||F.delay;n=n||"last";if(typeof t==="object"&&!(t instanceof Stepper)){e=t.delay||e;n=t.when||n;r=t.swing||r;i=t.times||i;s=t.wait||s;t=t.duration||F.duration}return{duration:t,delay:e,swing:r,times:i,wait:s,when:n}}active(t){if(t==null)return this.enabled;this.enabled=t;return this}addTransform(t,e){this.transforms.lmultiplyO(t);return this}after(t){return this.on("finished",t)}animate(t,e,n){const i=Runner.sanitise(t,e,n);const r=new Runner(i.duration);if(this._timeline)r.timeline(this._timeline);if(this._element)r.element(this._element);return r.loop(i).schedule(i.delay,i.when)}clearTransform(){this.transforms=new Matrix;return this}clearTransformsFromQueue(){if(!this.done||!this._timeline||!this._timeline._runnerIds.includes(this.id)){this._queue=this._queue.filter((t=>!t.isTransform))}}delay(t){return this.animate(0,t)}duration(){return this._times*(this._wait+this._duration)-this._wait}during(t){return this.queue(null,t)}ease(t){this._stepper=new Ease(t);return this}element(t){if(t==null)return this._element;this._element=t;t._prepareRunner();return this}finish(){return this.step(Infinity)}loop(t,e,n){if(typeof t==="object"){e=t.swing;n=t.wait;t=t.times}this._times=t||Infinity;this._swing=e||false;this._wait=n||0;if(this._times===true){this._times=Infinity}return this}loops(t){const e=this._duration+this._wait;if(t==null){const t=Math.floor(this._time/e);const n=this._time-t*e;const i=n/this._duration;return Math.min(t+i,this._times)}const n=Math.floor(t);const i=t%1;const r=e*n+this._duration*i;return this.time(r)}persist(t){if(t==null)return this._persist;this._persist=t;return this}position(t){const e=this._time;const n=this._duration;const i=this._wait;const r=this._times;const s=this._swing;const o=this._reverse;let a;if(t==null){const f=function(t){const e=s*Math.floor(t%(2*(i+n))/(i+n));const r=e&&!o||!e&&o;const a=Math.pow(-1,r)*(t%(i+n))/n+r;const h=Math.max(Math.min(a,1),0);return h};const t=r*(i+n)-i;a=e<=0?Math.round(f(1e-5)):e<t?f(e):Math.round(f(t-1e-5));return a}const h=Math.floor(this.loops());const l=s&&h%2===0;const c=l&&!o||o&&l;a=h+(c?t:1-t);return this.loops(a)}progress(t){if(t==null){return Math.min(1,this._time/this.duration())}return this.time(t*this.duration())}queue(t,e,n,i){this._queue.push({initialiser:t||noop,runner:e||noop,retarget:n,isTransform:i,initialised:false,finished:false});const r=this.timeline();r&&this.timeline()._continue();return this}reset(){if(this._reseted)return this;this.time(0);this._reseted=true;return this}reverse(t){this._reverse=t==null?!this._reverse:t;return this}schedule(t,e,n){if(!(t instanceof Timeline)){n=e;e=t;t=this.timeline()}if(!t){throw Error("Runner cannot be scheduled without timeline")}t.schedule(this,e,n);return this}step(t){if(!this.enabled)return this;t=t==null?16:t;this._time+=t;const e=this.position();const n=this._lastPosition!==e&&this._time>=0;this._lastPosition=e;const i=this.duration();const r=this._lastTime<=0&&this._time>0;const s=this._lastTime<i&&this._time>=i;this._lastTime=this._time;if(r){this.fire("start",this)}const o=this._isDeclarative;this.done=!o&&!s&&this._time>=i;this._reseted=false;let a=false;if(n||o){this._initialise(n);this.transforms=new Matrix;a=this._run(o?t:e);this.fire("step",this)}this.done=this.done||a&&o;if(s){this.fire("finished",this)}return this}time(t){if(t==null){return this._time}const e=t-this._time;this.step(e);return this}timeline(t){if(typeof t==="undefined")return this._timeline;this._timeline=t;return this}unschedule(){const t=this.timeline();t&&t.unschedule(this);return this}_initialise(t){if(!t&&!this._isDeclarative)return;for(let e=0,n=this._queue.length;e<n;++e){const n=this._queue[e];const i=this._isDeclarative||!n.initialised&&t;t=!n.finished;if(i&&t){n.initialiser.call(this);n.initialised=true}}}_rememberMorpher(t,e){this._history[t]={morpher:e,caller:this._queue[this._queue.length-1]};if(this._isDeclarative){const t=this.timeline();t&&t.play()}}_run(t){let e=true;for(let n=0,i=this._queue.length;n<i;++n){const i=this._queue[n];const r=i.runner.call(this,t);i.finished=i.finished||r===true;e=e&&i.finished}return e}_tryRetarget(t,e,n){if(this._history[t]){if(!this._history[t].caller.initialised){const e=this._queue.indexOf(this._history[t].caller);this._queue.splice(e,1);return false}if(this._history[t].caller.retarget){this._history[t].caller.retarget.call(this,e,n)}else{this._history[t].morpher.to(e)}this._history[t].caller.finished=false;const i=this.timeline();i&&i.play();return true}return false}}Runner.id=0;class FakeRunner{constructor(t=new Matrix,e=-1,n=true){this.transforms=t;this.id=e;this.done=n}clearTransformsFromQueue(){}}extend([Runner,FakeRunner],{mergeWith(t){return new FakeRunner(t.transforms.lmultiply(this.transforms),t.id)}});const lmultiply=(t,e)=>t.lmultiplyO(e);const getRunnerTransform=t=>t.transforms;function mergeTransforms(){const t=this._transformationRunners.runners;const e=t.map(getRunnerTransform).reduce(lmultiply,new Matrix);this.transform(e);this._transformationRunners.merge();if(this._transformationRunners.length()===1){this._frameId=null}}class RunnerArray{constructor(){this.runners=[];this.ids=[]}add(t){if(this.runners.includes(t))return;const e=t.id+1;this.runners.push(t);this.ids.push(e);return this}clearBefore(t){const e=this.ids.indexOf(t+1)||1;this.ids.splice(0,e,0);this.runners.splice(0,e,new FakeRunner).forEach((t=>t.clearTransformsFromQueue()));return this}edit(t,e){const n=this.ids.indexOf(t+1);this.ids.splice(n,1,t+1);this.runners.splice(n,1,e);return this}getByID(t){return this.runners[this.ids.indexOf(t+1)]}length(){return this.ids.length}merge(){let t=null;for(let e=0;e<this.runners.length;++e){const n=this.runners[e];const i=t&&n.done&&t.done&&(!n._timeline||!n._timeline._runnerIds.includes(n.id))&&(!t._timeline||!t._timeline._runnerIds.includes(t.id));if(i){this.remove(n.id);const i=n.mergeWith(t);this.edit(t.id,i);t=i;--e}else{t=n}}return this}remove(t){const e=this.ids.indexOf(t+1);this.ids.splice(e,1);this.runners.splice(e,1);return this}}registerMethods({Element:{animate(t,e,n){const i=Runner.sanitise(t,e,n);const r=this.timeline();return new Runner(i.duration).loop(i).element(this).timeline(r.play()).schedule(i.delay,i.when)},delay(t,e){return this.animate(0,t,e)},_clearTransformRunnersBefore(t){this._transformationRunners.clearBefore(t.id)},_currentTransform(t){return this._transformationRunners.runners.filter((e=>e.id<=t.id)).map(getRunnerTransform).reduce(lmultiply,new Matrix)},_addRunner(t){this._transformationRunners.add(t);it.cancelImmediate(this._frameId);this._frameId=it.immediate(mergeTransforms.bind(this))},_prepareRunner(){if(this._frameId==null){this._transformationRunners=(new RunnerArray).add(new FakeRunner(new Matrix(this)))}}}});const difference=(t,e)=>t.filter((t=>!e.includes(t)));extend(Runner,{attr(t,e){return this.styleAttr("attr",t,e)},css(t,e){return this.styleAttr("css",t,e)},styleAttr(t,e,n){if(typeof e==="string"){return this.styleAttr(t,{[e]:n})}let i=e;if(this._tryRetarget(t,i))return this;let r=new Morphable(this._stepper).to(i);let s=Object.keys(i);this.queue((function(){r=r.from(this.element()[t](s))}),(function(e){this.element()[t](r.at(e).valueOf());return r.done()}),(function(e){const n=Object.keys(e);const o=difference(n,s);if(o.length){const e=this.element()[t](o);const n=new ObjectBag(r.from()).valueOf();Object.assign(n,e);r.from(n)}const a=new ObjectBag(r.to()).valueOf();Object.assign(a,e);r.to(a);s=n;i=e}));this._rememberMorpher(t,r);return this},zoom(t,e){if(this._tryRetarget("zoom",t,e))return this;let n=new Morphable(this._stepper).to(new SVGNumber(t));this.queue((function(){n=n.from(this.element().zoom())}),(function(t){this.element().zoom(n.at(t),e);return n.done()}),(function(t,i){e=i;n.to(t)}));this._rememberMorpher("zoom",n);return this},transform(t,e,n){e=t.relative||e;if(this._isDeclarative&&!e&&this._tryRetarget("transform",t)){return this}const i=Matrix.isMatrixLike(t);n=t.affine!=null?t.affine:n!=null?n:!i;const r=new Morphable(this._stepper).type(n?TransformBag:Matrix);let s;let o;let a;let h;let l;function setup(){o=o||this.element();s=s||getOrigin(t,o);l=new Matrix(e?undefined:o);o._addRunner(this);if(!e){o._clearTransformRunnersBefore(this)}}function run(c){if(!e)this.clearTransform();const{x:u,y:d}=new Point(s).transform(o._currentTransform(this));let m=new Matrix({...t,origin:[u,d]});let p=this._isDeclarative&&a?a:l;if(n){m=m.decompose(u,d);p=p.decompose(u,d);const t=m.rotate;const e=p.rotate;const n=[t-360,t,t+360];const i=n.map((t=>Math.abs(t-e)));const r=Math.min(...i);const s=i.indexOf(r);m.rotate=n[s]}if(e){if(!i){m.rotate=t.rotate||0}if(this._isDeclarative&&h){p.rotate=h}}r.from(p);r.to(m);const g=r.at(c);h=g.rotate;a=new Matrix(g);this.addTransform(a);o._addRunner(this);return r.done()}function retarget(e){if((e.origin||"center").toString()!==(t.origin||"center").toString()){s=getOrigin(e,o)}t={...e,origin:s}}this.queue(setup,run,retarget,true);this._isDeclarative&&this._rememberMorpher("transform",r);return this},x(t,e){return this._queueNumber("x",t)},y(t){return this._queueNumber("y",t)},dx(t=0){return this._queueNumberDelta("x",t)},dy(t=0){return this._queueNumberDelta("y",t)},dmove(t,e){return this.dx(t).dy(e)},_queueNumberDelta(t,e){e=new SVGNumber(e);if(this._tryRetarget(t,e))return this;const n=new Morphable(this._stepper).to(e);let i=null;this.queue((function(){i=this.element()[t]();n.from(i);n.to(i+e)}),(function(e){this.element()[t](n.at(e));return n.done()}),(function(t){n.to(i+new SVGNumber(t))}));this._rememberMorpher(t,n);return this},_queueObject(t,e){if(this._tryRetarget(t,e))return this;const n=new Morphable(this._stepper).to(e);this.queue((function(){n.from(this.element()[t]())}),(function(e){this.element()[t](n.at(e));return n.done()}));this._rememberMorpher(t,n);return this},_queueNumber(t,e){return this._queueObject(t,new SVGNumber(e))},cx(t){return this._queueNumber("cx",t)},cy(t){return this._queueNumber("cy",t)},move(t,e){return this.x(t).y(e)},center(t,e){return this.cx(t).cy(e)},size(t,e){let n;if(!t||!e){n=this._element.bbox()}if(!t){t=n.width/n.height*e}if(!e){e=n.height/n.width*t}return this.width(t).height(e)},width(t){return this._queueNumber("width",t)},height(t){return this._queueNumber("height",t)},plot(t,e,n,i){if(arguments.length===4){return this.plot([t,e,n,i])}if(this._tryRetarget("plot",t))return this;const r=new Morphable(this._stepper).type(this._element.MorphArray).to(t);this.queue((function(){r.from(this._element.array())}),(function(t){this._element.plot(r.at(t));return r.done()}));this._rememberMorpher("plot",r);return this},leading(t){return this._queueNumber("leading",t)},viewbox(t,e,n,i){return this._queueObject("viewbox",new Box(t,e,n,i))},update(t){if(typeof t!=="object"){return this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]})}if(t.opacity!=null)this.attr("stop-opacity",t.opacity);if(t.color!=null)this.attr("stop-color",t.color);if(t.offset!=null)this.attr("offset",t.offset);return this}});extend(Runner,{rx:rx,ry:ry,from:from,to:to});register(Runner,"Runner");class Svg extends Container{constructor(t,e=t){super(nodeOrNew("svg",t),e);this.namespace()}defs(){if(!this.isRoot())return this.root().defs();return adopt(this.node.querySelector("defs"))||this.put(new Defs)}isRoot(){return!this.node.parentNode||!(this.node.parentNode instanceof d.window.SVGElement)&&this.node.parentNode.nodeName!=="#document-fragment"}namespace(){if(!this.isRoot())return this.root().namespace();return this.attr({xmlns:o,version:"1.1"}).attr("xmlns:xlink",l,h).attr("xmlns:svgjs",c,h)}removeNamespace(){return this.attr({xmlns:null,version:null}).attr("xmlns:xlink",null,h).attr("xmlns:svgjs",null,h)}root(){if(this.isRoot())return this;return super.root()}}registerMethods({Container:{nested:wrapWithAttrCheck((function(){return this.put(new Svg)}))}});register(Svg,"Svg",true);class Symbol extends Container{constructor(t,e=t){super(nodeOrNew("symbol",t),e)}}registerMethods({Container:{symbol:wrapWithAttrCheck((function(){return this.put(new Symbol)}))}});register(Symbol,"Symbol");function plain(t){if(this._build===false){this.clear()}this.node.appendChild(d.document.createTextNode(t));return this}function svg_esm_length(){return this.node.getComputedTextLength()}function x$1(t,e=this.bbox()){if(t==null){return e.x}return this.attr("x",this.attr("x")+t-e.x)}function y$1(t,e=this.bbox()){if(t==null){return e.y}return this.attr("y",this.attr("y")+t-e.y)}function move$1(t,e,n=this.bbox()){return this.x(t,n).y(e,n)}function cx(t,e=this.bbox()){if(t==null){return e.cx}return this.attr("x",this.attr("x")+t-e.cx)}function cy(t,e=this.bbox()){if(t==null){return e.cy}return this.attr("y",this.attr("y")+t-e.cy)}function center(t,e,n=this.bbox()){return this.cx(t,n).cy(e,n)}function ax(t){return this.attr("x",t)}function ay(t){return this.attr("y",t)}function amove(t,e){return this.ax(t).ay(e)}function build(t){this._build=!!t;return this}var rt={__proto__:null,plain:plain,length:svg_esm_length,x:x$1,y:y$1,move:move$1,cx:cx,cy:cy,center:center,ax:ax,ay:ay,amove:amove,build:build};class Text extends Shape{constructor(t,e=t){super(nodeOrNew("text",t),e);this.dom.leading=new SVGNumber(1.3);this._rebuild=true;this._build=false}leading(t){if(t==null){return this.dom.leading}this.dom.leading=new SVGNumber(t);return this.rebuild()}rebuild(t){if(typeof t==="boolean"){this._rebuild=t}if(this._rebuild){const t=this;let e=0;const n=this.dom.leading;this.each((function(i){const r=d.window.getComputedStyle(this.node).getPropertyValue("font-size");const s=n*new SVGNumber(r);if(this.dom.newLined){this.attr("x",t.attr("x"));if(this.text()==="\n"){e+=s}else{this.attr("dy",i?s+e:0);e=0}}}));this.fire("rebuild")}return this}setData(t){this.dom=t;this.dom.leading=new SVGNumber(t.leading||1.3);return this}text(t){if(t===undefined){const e=this.node.childNodes;let n=0;t="";for(let i=0,r=e.length;i<r;++i){if(e[i].nodeName==="textPath"){if(i===0)n=1;continue}if(i!==n&&e[i].nodeType!==3&&adopt(e[i]).dom.newLined===true){t+="\n"}t+=e[i].textContent}return t}this.clear().build(true);if(typeof t==="function"){t.call(this,this)}else{t=(t+"").split("\n");for(let e=0,n=t.length;e<n;e++){this.newLine(t[e])}}return this.build(false).rebuild()}}extend(Text,rt);registerMethods({Container:{text:wrapWithAttrCheck((function(t=""){return this.put(new Text).text(t)})),plain:wrapWithAttrCheck((function(t=""){return this.put(new Text).plain(t)}))}});register(Text,"Text");class Tspan extends Shape{constructor(t,e=t){super(nodeOrNew("tspan",t),e);this._build=false}dx(t){return this.attr("dx",t)}dy(t){return this.attr("dy",t)}newLine(){this.dom.newLined=true;const t=this.parent();if(!(t instanceof Text)){return this}const e=t.index(this);const n=d.window.getComputedStyle(this.node).getPropertyValue("font-size");const i=t.dom.leading*new SVGNumber(n);return this.dy(e?i:0).attr("x",t.x())}text(t){if(t==null)return this.node.textContent+(this.dom.newLined?"\n":"");if(typeof t==="function"){this.clear().build(true);t.call(this,this);this.build(false)}else{this.plain(t)}return this}}extend(Tspan,rt);registerMethods({Tspan:{tspan:wrapWithAttrCheck((function(t=""){const e=new Tspan;if(!this._build){this.clear()}return this.put(e).text(t)}))},Text:{newLine:function(t=""){return this.tspan(t).newLine()}}});register(Tspan,"Tspan");class Circle extends Shape{constructor(t,e=t){super(nodeOrNew("circle",t),e)}radius(t){return this.attr("r",t)}rx(t){return this.attr("r",t)}ry(t){return this.rx(t)}size(t){return this.radius(new SVGNumber(t).divide(2))}}extend(Circle,{x:x$3,y:y$3,cx:cx$1,cy:cy$1,width:width$2,height:height$2});registerMethods({Container:{circle:wrapWithAttrCheck((function(t=0){return this.put(new Circle).size(t).move(0,0)}))}});register(Circle,"Circle");class ClipPath extends Container{constructor(t,e=t){super(nodeOrNew("clipPath",t),e)}remove(){this.targets().forEach((function(t){t.unclip()}));return super.remove()}targets(){return baseFind('svg [clip-path*="'+this.id()+'"]')}}registerMethods({Container:{clip:wrapWithAttrCheck((function(){return this.defs().put(new ClipPath)}))},Element:{clipper(){return this.reference("clip-path")},clipWith(t){const e=t instanceof ClipPath?t:this.parent().clip().add(t);return this.attr("clip-path",'url("#'+e.id()+'")')},unclip(){return this.attr("clip-path",null)}}});register(ClipPath,"ClipPath");class ForeignObject extends Element{constructor(t,e=t){super(nodeOrNew("foreignObject",t),e)}}registerMethods({Container:{foreignObject:wrapWithAttrCheck((function(t,e){return this.put(new ForeignObject).size(t,e)}))}});register(ForeignObject,"ForeignObject");function dmove(t,e){this.children().forEach(((n,i)=>{let r;try{r=n.bbox()}catch(t){return}const s=new Matrix(n);const o=s.translate(t,e).transform(s.inverse());const a=new Point(r.x,r.y).transform(o);n.move(a.x,a.y)}));return this}function dx(t){return this.dmove(t,0)}function dy(t){return this.dmove(0,t)}function height(t,e=this.bbox()){if(t==null)return e.height;return this.size(e.width,t,e)}function move(t=0,e=0,n=this.bbox()){const i=t-n.x;const r=e-n.y;return this.dmove(i,r)}function size(t,e,n=this.bbox()){const i=proportionalSize(this,t,e,n);const r=i.width/n.width;const s=i.height/n.height;this.children().forEach(((t,e)=>{const i=new Point(n).transform(new Matrix(t).inverse());t.scale(r,s,i.x,i.y)}));return this}function width(t,e=this.bbox()){if(t==null)return e.width;return this.size(t,e.height,e)}function x(t,e=this.bbox()){if(t==null)return e.x;return this.move(t,e.y,e)}function y(t,e=this.bbox()){if(t==null)return e.y;return this.move(e.x,t,e)}var st={__proto__:null,dmove:dmove,dx:dx,dy:dy,height:height,move:move,size:size,width:width,x:x,y:y};class G extends Container{constructor(t,e=t){super(nodeOrNew("g",t),e)}}extend(G,st);registerMethods({Container:{group:wrapWithAttrCheck((function(){return this.put(new G)}))}});register(G,"G");class A extends Container{constructor(t,e=t){super(nodeOrNew("a",t),e)}target(t){return this.attr("target",t)}to(t){return this.attr("href",t,l)}}extend(A,st);registerMethods({Container:{link:wrapWithAttrCheck((function(t){return this.put(new A).to(t)}))},Element:{unlink(){const t=this.linker();if(!t)return this;const e=t.parent();if(!e){return this.remove()}const n=e.index(t);e.add(this,n);t.remove();return this},linkTo(t){let e=this.linker();if(!e){e=new A;this.wrap(e)}if(typeof t==="function"){t.call(e,e)}else{e.to(t)}return this},linker(){const t=this.parent();if(t&&t.node.nodeName.toLowerCase()==="a"){return t}return null}}});register(A,"A");class Mask extends Container{constructor(t,e=t){super(nodeOrNew("mask",t),e)}remove(){this.targets().forEach((function(t){t.unmask()}));return super.remove()}targets(){return baseFind('svg [mask*="'+this.id()+'"]')}}registerMethods({Container:{mask:wrapWithAttrCheck((function(){return this.defs().put(new Mask)}))},Element:{masker(){return this.reference("mask")},maskWith(t){const e=t instanceof Mask?t:this.parent().mask().add(t);return this.attr("mask",'url("#'+e.id()+'")')},unmask(){return this.attr("mask",null)}}});register(Mask,"Mask");class Stop extends Element{constructor(t,e=t){super(nodeOrNew("stop",t),e)}update(t){if(typeof t==="number"||t instanceof SVGNumber){t={offset:arguments[0],color:arguments[1],opacity:arguments[2]}}if(t.opacity!=null)this.attr("stop-opacity",t.opacity);if(t.color!=null)this.attr("stop-color",t.color);if(t.offset!=null)this.attr("offset",new SVGNumber(t.offset));return this}}registerMethods({Gradient:{stop:function(t,e,n){return this.put(new Stop).update(t,e,n)}}});register(Stop,"Stop");function cssRule(t,e){if(!t)return"";if(!e)return t;let n=t+"{";for(const t in e){n+=unCamelCase(t)+":"+e[t]+";"}n+="}";return n}class Style extends Element{constructor(t,e=t){super(nodeOrNew("style",t),e)}addText(t=""){this.node.textContent+=t;return this}font(t,e,n={}){return this.rule("@font-face",{fontFamily:t,src:e,...n})}rule(t,e){return this.addText(cssRule(t,e))}}registerMethods("Dom",{style(t,e){return this.put(new Style).rule(t,e)},fontface(t,e,n){return this.put(new Style).font(t,e,n)}});register(Style,"Style");class TextPath extends Text{constructor(t,e=t){super(nodeOrNew("textPath",t),e)}array(){const t=this.track();return t?t.array():null}plot(t){const e=this.track();let n=null;if(e){n=e.plot(t)}return t==null?n:this}track(){return this.reference("href")}}registerMethods({Container:{textPath:wrapWithAttrCheck((function(t,e){if(!(t instanceof Text)){t=this.text(t)}return t.path(e)}))},Text:{path:wrapWithAttrCheck((function(t,e=true){const n=new TextPath;if(!(t instanceof Path)){t=this.defs().path(t)}n.attr("href","#"+t,l);let i;if(e){while(i=this.node.firstChild){n.node.appendChild(i)}}return this.put(n)})),textPath(){return this.findOne("textPath")}},Path:{text:wrapWithAttrCheck((function(t){if(!(t instanceof Text)){t=(new Text).addTo(this.parent()).text(t)}return t.path(this)})),targets(){return baseFind("svg textPath").filter((t=>(t.attr("href")||"").includes(this.id())))}}});TextPath.prototype.MorphArray=PathArray;register(TextPath,"TextPath");class Use extends Shape{constructor(t,e=t){super(nodeOrNew("use",t),e)}use(t,e){return this.attr("href",(e||"")+"#"+t,l)}}registerMethods({Container:{use:wrapWithAttrCheck((function(t,e){return this.put(new Use).use(t,e)}))}});register(Use,"Use");const ot=makeInstance;extend([Svg,Symbol,Image,Pattern,Marker],getMethodsFor("viewbox"));extend([Line,Polyline,Polygon,Path],getMethodsFor("marker"));extend(Text,getMethodsFor("Text"));extend(Path,getMethodsFor("Path"));extend(Defs,getMethodsFor("Defs"));extend([Text,Tspan],getMethodsFor("Tspan"));extend([Rect,Ellipse,Gradient,Runner],getMethodsFor("radius"));extend(EventTarget,getMethodsFor("EventTarget"));extend(Dom,getMethodsFor("Dom"));extend(Element,getMethodsFor("Element"));extend(Shape,getMethodsFor("Shape"));extend([Container,Fragment],getMethodsFor("Container"));extend(Gradient,getMethodsFor("Gradient"));extend(Runner,getMethodsFor("Runner"));List.extend(getMethodNames());registerMorphableType([SVGNumber,Color,Box,Matrix,SVGArray,PointArray,PathArray,Point]);makeMorphable();
/*!
 * @svgdotjs/svg.draggable.js - An extension for svg.js which allows to drag elements with your mouse
 * @version 3.0.2
 * https://github.com/svgdotjs/svg.draggable.js
 *
 * @copyright Wout Fierens
 * @license MIT
 *
 * BUILT: Tue Feb 19 2019 17:12:16 GMT+0100 (GMT+01:00)
 */
function draggable(t){"use strict";function _classCallCheck(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){if(e)_defineProperties(t.prototype,e);if(n)_defineProperties(t,n);return t}var e=function getCoordsFromEvent(t){if(t.changedTouches){t=t.changedTouches[0]}return{x:t.clientX,y:t.clientY}};var n=function(){function DragHandler(t){_classCallCheck(this,DragHandler);t.remember("_draggable",this);this.el=t;this.drag=this.drag.bind(this);this.startDrag=this.startDrag.bind(this);this.endDrag=this.endDrag.bind(this)}_createClass(DragHandler,[{key:"init",value:function init(t){if(t){this.el.on("mousedown.drag",this.startDrag);this.el.on("touchstart.drag",this.startDrag)}else{this.el.off("mousedown.drag");this.el.off("touchstart.drag")}}},{key:"startDrag",value:function startDrag(n){var i=!n.type.indexOf("mouse");if(i&&(n.which||n.buttons)!==1){return}if(this.el.dispatch("beforedrag",{event:n,handler:this}).defaultPrevented){return}n.preventDefault();n.stopPropagation();this.init(false);this.box=this.el.bbox();this.lastClick=this.el.point(e(n));var r=(i?"mousemove":"touchmove")+".drag";var s=(i?"mouseup":"touchcancel.drag touchend")+".drag";t.on(window,r,this.drag);t.on(window,s,this.endDrag);this.el.fire("dragstart",{event:n,handler:this,box:this.box})}},{key:"drag",value:function drag(n){var i=this.box,r=this.lastClick;var s=this.el.point(e(n));var o=i.x+(s.x-r.x);var a=i.y+(s.y-r.y);var h=new t.Box(o,a,i.w,i.h);if(this.el.dispatch("dragmove",{event:n,handler:this,box:h}).defaultPrevented)return;this.move(o,a);return h}},{key:"move",value:function move(e,n){if(this.el.type==="svg"){t.G.prototype.move.call(this.el,e,n)}else{this.el.move(e,n)}}},{key:"endDrag",value:function endDrag(e){var n=this.drag(e);this.el.fire("dragend",{event:e,handler:this,box:n});t.off(window,"mousemove.drag");t.off(window,"touchmove.drag");t.off(window,"mouseup.drag");t.off(window,"touchend.drag");this.init(true)}}]);return DragHandler}();t.extend(t.Element,{draggable:function draggable(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var e=this.remember("_draggable")||new n(this);e.init(t);return this}})}class TextOverlay{constructor(t,e){this.svg=t;this.color=e;this.fontSize=11;this.border=2;this._x=0;this._y=0;this._hidden=false;this.group=this.svg.group();this.group.front().mouseover((()=>this.group.front()));this.textElement=this.group.text("a").addClass("overlay").font({anchor:"middle",size:this.fontSize});this.rect=this.group.rect(this.textElement.length()+this.border*2,this.fontSize+this.border*2).radius(3).fill(this.color).stroke(this.color).back();this.recenter()}set hidden(t){this._hidden=t;if(t)this.group.hide();else this.group.show()}addClass(t){this.group.addClass(t);return this}hide(){this.hidden=true;return this}show(){this.hidden=false;return this}mousedown(t){this.group.mousedown((e=>{t(e)}));return this}move(t,e){this._x=t;this._y=e;this.textElement.center(t,e);this.rect.center(t,e);this.top();return this}recenter(){this.rect.size(this.textElement.length()+this.border*2,this.fontSize+this.border*2);this.textElement.center(this._x,this._y);this.rect.center(this._x,this._y);return this}text(t){this.textElement.text(`${t}`);this.recenter();return this}top(){this.rect.front();this.textElement.front();this.group.front();return this}}const at=["#332288","#117733","#44AA99","#88CCEE","#DDCC77","#CC6677","#AA4499","#882255"];class Label{constructor(t,e,n,i){this.panel=t;this.criterion=n;this.color=at[e.i%at.length];n.color=this.color;this.offset=e;this.labelsGroup=t.labelsGroup.group();this.slidersGroup=t.svg.group();this.weight=0;this.blurIntensity=0;this.constraints=null;this.ellipse=null;this.callback=i;this.label=this.labelsGroup.text(n.description).move(e.x,e.y).fill(this.color).mousedown((t=>{this.onMousedown(t)}));this.labelBbox=this.label.bbox();this.LineOrigin={x:this.labelBbox.x2,y:this.labelBbox.cy};if(this.criterion.weight>0){this.createHandle(0,0)}n.on("updated",(()=>{if(this.weight!==this.criterion.weight||this.blurIntensity!==this.criterion.blurIntensity){if(this.ellipse===null){this.createHandle(0,0)}this.updatePosition()}}))}set stageBox(t){const{x2:e,y2:n}=t;const i=Math.max(0,this.label.bbox().x2-10);const r=Math.max(0,this.label.bbox().y-10);this.constraints=new SVG.Box(i,r,e-i+10,n-r+10)}onMousedown(t){if(this.ellipse===null){this.createHandle(t.offsetX,t.offsetY)}else{this.moveHandle(t.offsetX,t.offsetY)}this.show();this.ellipse.remember("_draggable").startDrag(t)}onDrag(t){const{x:e,y:n}=constrain(this.constraints,t);this.moveHandle(e,n)}updatePosition(){if(this.criterion.weight>0){this.weight=this.criterion.weight;this.blurIntensity=this.criterion.blurIntensity;const t=this.panel.inverseMapWeight(this.criterion.weight);const e=this.panel.inversemapBlur(this.criterion.blurIntensity);this.moveHandle(t,e)}}moveHandle(t,e){this.ellipse.center(t,e);const n=t-Math.abs(e-this.LineOrigin.y);this.line.plot([this.LineOrigin.x,this.LineOrigin.y,n,this.LineOrigin.y,t,e,n,this.LineOrigin.y]).back();this.weightLine.plot([n,this.LineOrigin.y,t,this.LineOrigin.y,t,this.LineOrigin.y-4,t,this.LineOrigin.y+4,t,this.LineOrigin.y]);this.weight=round(this.panel.mapWeight(t),2);this.criterion.weight=this.weight;this.weightOverlay.move(lerp(this.LineOrigin.x,t+this.weightOverlay.textElement.length()/2,1),this.LineOrigin.y).text("Importance: "+this.criterion.weight).hidden=!(this.criterion.weight>0);this.blurIntensity=Math.max(0,round(this.panel.mapBlur(e),2));this.criterion.blurIntensity=this.blurIntensity;this.granularityOverlay.move(t-this.granularityOverlay.textElement.length()/2-7,e).text(`Granularity: ${prettyPrintPercent(this.criterion.blurIntensity)} - ${this.criterion.classCount} classes`).hidden=!(this.criterion.weight>0&&this.criterion.blurIntensity>0)}show(){this.slidersGroup.show()}hide(){this.slidersGroup.hide()}createHandle(t,e){const n=this.label.bbox();const i=n.x2,r=n.y+n.h/2,s=2.5+t,o=2.5+e,a=s-Math.abs(o-r);this.line=this.slidersGroup.polyline([this.LineOrigin.x,this.LineOrigin.y,a,r,s,o,a,r]).stroke(this.color).back();this.weightLine=this.slidersGroup.polyline([a,this.LineOrigin.y,s,this.LineOrigin.y,s,this.LineOrigin.y-2,s,this.LineOrigin.y+2]).stroke(this.color).addClass("dashed").back();this.ellipse=this.slidersGroup.ellipse().fill(this.color).draggable().addClass("bidirectionnel").move(2.5+t,2.5+e).on("dragmove.namespace",(t=>this.onDrag(t))).on("dragend.namespace",(()=>{this.constraints.axis=null;if(this.criterion.weight<=0)this.hide();this.callback(this)}));this.weightOverlay=new TextOverlay(this.slidersGroup.parent(),this.color).move(lerp(i,a,.2),r).hide().addClass("horizontal").mousedown((t=>axisConstraint(this,"y",t)));this.granularityOverlay=new TextOverlay(this.slidersGroup.parent(),this.color).hide().addClass("vertical").mousedown((t=>axisConstraint(this,"x",t)))}}const axisConstraint=(t,e,n)=>{t.constraints.axis=e;t.constraints.constant=t.ellipse[e]();t.ellipse.remember("_draggable").startDrag(n)};function constrain(t,e){const{handler:n,box:i}=e.detail;e.preventDefault();let{x:r,y:s}=i;if(r<t.x){r=t.x}if(s<t.y){s=t.y}if(i.x2>t.x2){r=t.x2-i.w}if(i.y2>t.y2){s=t.y2-i.h}if(t.axis==="y")s=t.constant;if(t.axis==="x")r=t.constant;return{x:r,y:s}}window.SVG=n;class UI{constructor(t,e,n){this.dimensions={width:"100%",height:"500px"};this.restAreaWidth=100;this._initSvg(t,this.dimensions).then((()=>{this._setupCriteria(e)._setupStage();if(typeof n==="function")return n();return null}))}_initSvg(t,e){window.SVG=n;draggable(window.SVG);return Promise.resolve().then((()=>{this.svg=ot().addTo(t).size(e.width,e.height);const n=this.svg.rect("100%","100%");this.dimensions=n.bbox();n.remove();const reload=()=>{const t=this.svg.rect("100%","100%");this.dimensions=t.bbox();t.remove();this._cleanUpStage()._setupStage()};window.addEventListener("resize",reload);$(".tabs").tabs({onShow:reload});return this}))}_setupStage(){const t=5;const{x:e,y:n,w:i,h:r}=this.labelsGroup.bbox();const{x2:s,y2:o}=this.dimensions;this.labelBox=new SVG.Box(e-t,n,i+2*t,r);this.stageBox=new SVG.Box(this.labelBox.x2,this.labelBox.y2,s-this.labelBox.x2,o-this.labelBox.y2);this.areas={};this.areas.labels=this.labelsGroup.rect(this.labelBox.w,"100%").move(this.labelBox.x,this.labelBox.y).addClass("labelsGroup").back();this.areas.stage=this.svg.rect(this.stageBox.w,this.stageBox.h).move(this.stageBox.x,this.stageBox.y).fill("#eee").back();this.areas.axis=this.svg.group();const a=this.areas.axis.text("Importance").fill("#bbb").addClass("dropshadow").font({anchor:"left",size:20});a.move(this.stageBox.x2-a.length()-2,this.stageBox.y);this.areas.axis.textPath("Granularity").fill("#bbb").addClass("dropshadow").font({anchor:"left",size:20}).plot(`M ${this.stageBox.x-10} ${this.stageBox.y2-2} L ${this.stageBox.x-10} ${this.stageBox.y+10}`);const h=this.areas.axis.text("<- Drag criteria from the left to start ordering technologies").fill("#bbb").font({anchor:"left",size:20});h.move(this.stageBox.x+this.stageBox.w/2-h.length()/2,this.labelBox.h/2);this.mapWeight=map(this.stageBox.x,this.stageBox.w,0,10);this.mapBlur=mapClamped(this.stageBox.y,this.stageBox.h,0,.2);this.inverseMapWeight=map(0,10,this.stageBox.x,this.stageBox.w);this.inversemapBlur=map(0,.2,this.stageBox.y,this.stageBox.h);for(const t of this.labels){t.stageBox=this.stageBox;t.updatePosition()}return this}_cleanUpStage(){this.areas.labels.remove();this.areas.stage.remove();this.areas.axis.remove();return this}_setupCriteria(t){this.labelsGroup=this.svg.group();this.labels=[];let e=0;for(const n of t){this.labels.push(new Label(this,{i:e,x:5,y:15*++e},n,(t=>{})))}return this}}window.SVG=n;const ht={dominance:"dominance",rank:"rank",centroid:"centroid"};class ParallelCoordinatesPlotPanel{constructor(t,e){this.dimensions={width:"100%",height:"300px"};this.mode=ht.dominance;this._initSvg(t,this.dimensions)._setupStage()}update(t,e){this._cachedTechnologies=t;this._cachedCriteria=e;this._cleanUpStage()._setupStage(e);t.forEach(((n,i)=>this._drawTechnology(n,e,i,t.length)))}_initSvg(t,e){window.SVG=n;this.svg=ot().addTo(t).size(e.width,e.height);this.paddingTop=15;this._updateSize();window.addEventListener("resize",(()=>{this._updateSize();this._cleanUpStage()._setupStage()}));return this}_updateSize(){const t=this.svg.rect("100%","100%");this.dimensions=t.bbox();this.dimensions.height-=this.paddingTop;t.remove()}_getAxisPosition(t,e){return this.dimensions.width/(e-1)*t}_setupStage(t){this._drawStage(t);return this}_drawStage(t){this.stage=this.svg.group();this.stage.attr({id:"stage"});this.stage.attr({"stroke-width":1});this.stage.translate(0,this.paddingTop);this._setupCriteria(t);this.technologyLabels=this.stage.group();this.modeText=this.stage.text(this.mode);this.modeText.attr({"font-size":12,"font-family":"sans-serif",fill:"black","text-anchor":"start"});this.modeText.move(10,-this.paddingTop);this.modeText.on("click",(()=>{const t=Object.values(ht);const e=t.indexOf(this.mode);this.mode=t[(e+1)%t.length];this.modeText.text(this.mode);this.update(this._cachedTechnologies,this._cachedCriteria)}))}_setupCriteria(t){this.criteria=t??this.criteria??[];this.axisLabels=this.stage.group();this.axisLabels.attr({id:"axisLabels"});this.criteria.forEach(((t,e,n)=>{this._drawAxis(t,e,n.length);this._drawLabel(t,e,n.length)}));return this}_drawAxis(t,e,n){const i=this.axisLabels.line(0,0,0,this.dimensions.height);i.attr({"stroke-width":1,stroke:t.color});i.move(this._getAxisPosition(e,n),0)}_drawLabel(t,e,n){const i=this.axisLabels.text(t.name);i.attr({"font-size":12,"font-family":"sans-serif",fill:t.color,"text-anchor":"start"});i.move(this._getAxisPosition(e,n)+5,-8);if(e===n-1)i.move(this._getAxisPosition(e,n)+5,5);i.rotate(90,this._getAxisPosition(e,n)+5,0)}_cleanUpStage(){this.stage.remove();this.axisLabels.remove();return this}_drawTechnology(t,e,n,i){const r=e.filter((t=>t._weight>0));const s=r.map(((e,i)=>[this._getAxisPosition(i,r.length),this._getTechnologyPosition(t,e,n,r.length)]));const o=this.stage.polyline(s);this._colorTechnology(o,t,n,i);o.on("click",(()=>{this._drawTechnologyLabels(t,e);t.selected=!t.selected;e[0].update();this._colorTechnology(o,t,n)}))}_colorTechnology(t,e,n,i){t.attr({fill:"none",stroke:e.selected?"rgb(0,255,0)":mapIndexToColor(n,i),"stroke-width":e.selected?5:2})}_getTechnologyPosition(t,e,n,i,r="rank"){const s=centeredUnitRandom(n)*e.blurIntensity/8;const o={rank:t.rank[e.name]/(e.classCount-1),dominance:t.dominance[e.name]/(e.maxDominance-1),centroid:e.classes[t.dominance[e.name]].centroidNormal};return this.dimensions.height*clamp(1-o[this.mode]+s,0,1)}_drawTechnologyLabels(t,e){this.technologyLabels.clear();const n=e.filter((t=>t._weight>0));n.forEach(((e,i)=>{const r=this.technologyLabels.text(`${e.name}: ${t.dominance[e.name]}`);r.attr({"font-size":12,"font-family":"sans-serif"});r.move(this._getAxisPosition(i,n.length)+5,this._getTechnologyPosition(t,e,i,n.length)+5)}))}}function mapIndexToColor(t,e){const n=Math.floor(255*t/e);const i=Math.floor(255*(e-t)/e);return`rgba(${n}, 0, ${i}, 0.5)`}let lt={},ct={};ct.attr=function(t,e,n,i){if(!1===e||null==e||!e&&("class"===t||"style"===t))return"";if(!0===e)return" "+(i?t:t+'="'+t+'"');var r=typeof e;return"object"!==r&&"function"!==r||"function"!=typeof e.toJSON||(e=e.toJSON()),"string"==typeof e||(e=JSON.stringify(e),n||-1===e.indexOf('"'))?(n&&(e=ct.escape(e))," "+t+'="'+e+'"'):" "+t+"='"+e.replace(/'/g,"&#39;")+"'"};ct.attrs=function(t,e){var n="";for(var i in t)if(ut.call(t,i)){var r=t[i];if("class"===i){r=ct.classes(r),n=ct.attr(i,r,!1,e)+n;continue}"style"===i&&(r=ct.style(r)),n+=pug_attr(i,r,!1,e)}return n};ct.classes=function(t,e){return Array.isArray(t)?ct.classes_array(t,e):t&&"object"==typeof t?ct.classes_object(t):t||""};ct.classes_array=function(t,e){for(var n,i="",r="",s=Array.isArray(e),o=0;o<t.length;o++)(n=pug_classes(t[o]))&&(s&&e[o]&&(n=pug_escape(n)),i=i+r+n,r=" ");return i};ct.classes_object=function(t){var e="",n="";for(var i in t)i&&t[i]&&ut.call(t,i)&&(e=e+n+i,n=" ");return e};ct.escape=function(t){var e=""+t,n=dt.exec(e);if(!n)return t;var i,r,s,o="";for(i=n.index,r=0;i<e.length;i++){switch(e.charCodeAt(i)){case 34:s="&quot;";break;case 38:s="&amp;";break;case 60:s="&lt;";break;case 62:s="&gt;";break;default:continue}r!==i&&(o+=e.substring(r,i)),r=i+1,o+=s}return r!==i?o+e.substring(r,i):o};var ut=Object.prototype.hasOwnProperty;var dt=/["&<>]/;ct.merge=function(t,e){if(1===arguments.length){for(var n=t[0],i=1;i<t.length;i++)n=ct.merge(n,t[i]);return n}for(var r in e)if("class"===r){var s=t[r]||[];t[r]=(Array.isArray(s)?s:[s]).concat(e[r]||[])}else if("style"===r){var s=pug_style(t[r]);s=s&&";"!==s[s.length-1]?s+";":s;var o=pug_style(e[r]);o=o&&";"!==o[o.length-1]?o+";":o,t[r]=s+o}else t[r]=e[r];return t};ct.rethrow=function(t,e,n,i){if(!(t instanceof Error))throw t;if(!("undefined"==typeof window&&e||i))throw t.message+=" on line "+n,t;var r,s,o,a;try{i=i||require("fs").readFileSync(e,{encoding:"utf8"}),r=3,s=i.split("\n"),o=Math.max(n-r,0),a=Math.min(s.length,n+r)}catch(i){return t.message+=" - could not read from "+e+" ("+i.message+")",void ct.rethrow(t,null,n)}r=s.slice(o,a).map((function(t,e){var i=e+o+1;return(i==n?"  > ":"    ")+i+"| "+t})).join("\n"),t.path=e;try{t.message=(e||"Pug")+":"+n+"\n"+r+"\n\n"+t.message}catch(t){}throw t};ct.style=function(t){if(!t)return"";if("object"==typeof t){var e="";for(var n in t)ut.call(t,n)&&(e=e+n+":"+t[n]+";");return e}return t+""};lt.table=function(t){var e="",n={},i;var r=t||{};(function(t,n,r,s,o){function fixed2(t){return r.parseFloat(t).toFixed(2)}const a=["star","star_half","star_border"];function star(e){e=n.min(1,n.max(0,e))||0;const i=n.floor(e*5),r=n.floor(e*10)%2;return[i,r,5-i-r].map(((e,n)=>t(e).fill(a[n]))).flat()}const h=s.filter((t=>t.weight>0)).sort(((t,e)=>t.weight-e.weight));e=e+'<table class="responsive-table striped compactTable"><thead><tr class="hide-on-med-and-down"><th>Technology</th><th><div class="flex"><span class="orange-text">score</span></div></th>';(function(){var t=h;if("number"==typeof t.length){for(var r=0,s=t.length;r<s;r++){var o=t[r];e=e+'<th><div class="flex">';let s=`color:${o.color}`;e=e+"<span"+ct.attr("style",ct.style(s),true,false)+">"+ct.escape(null==(i=o.name)?"":i)+'</span></div><div class="hide-on-med-and-down flex small"><span>importance</span><span>granularity</span></div><div class="hide-on-med-and-down flex small"><span>'+ct.escape(null==(i=fixed2(o.weight))?"":i)+"</span><span>"+ct.escape(null==(i=n.floor(o.blurIntensity*100))?"":i)+"% - "+ct.escape(null==(i=o.classCount)?"":i)+" classes</span></div></th>"}}else{var s=0;for(var r in t){s++;var o=t[r];e=e+'<th><div class="flex">';let a=`color:${o.color}`;e=e+"<span"+ct.attr("style",ct.style(a),true,false)+">"+ct.escape(null==(i=o.name)?"":i)+'</span></div><div class="hide-on-med-and-down flex small"><span>importance</span><span>granularity</span></div><div class="hide-on-med-and-down flex small"><span>'+ct.escape(null==(i=fixed2(o.weight))?"":i)+"</span><span>"+ct.escape(null==(i=n.floor(o.blurIntensity*100))?"":i)+"% - "+ct.escape(null==(i=o.classCount)?"":i)+" classes</span></div></th>"}}}).call(this);e=e+'</tr><tr class="hide-on-large-only"><th>Technology</th><th class="orange-text">score</th>';(function(){var t=h;if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var s=t[n];if(s.weight>0){let t=`color:${s.color}`;e=e+"<th"+ct.attr("style",ct.style(t),true,false)+">"+ct.escape(null==(i=s.name)?"":i)+"</th>"}}}else{var r=0;for(var n in t){r++;var s=t[n];if(s.weight>0){let t=`color:${s.color}`;e=e+"<th"+ct.attr("style",ct.style(t),true,false)+">"+ct.escape(null==(i=s.name)?"":i)+"</th>"}}}}).call(this);e=e+"</tr></thead><tbody>";(function(){var t=o;if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var s=t[n];const r=`background-color:${s.selected?"lightgreen":"white"}`;e=e+"<tr"+(' class="technology"'+ct.attr("data-technology",s.name,true,false)+ct.attr("style",ct.style(r),true,false))+"><td>"+ct.escape(null==(i=s.description)?"":i)+"</td>";const o=h.reduce(((t,e)=>t+e.weight),0);const a=h.map((t=>({name:t.name,weight:fixed2(t.weight),normalizedDominance:fixed2(s.dominance[t.name]/t.maxDominance),partialScore:fixed2(t.weight*s.dominance[t.name]/t.maxDominance),normalizedPartialScore:fixed2(t.weight*s.dominance[t.name]/t.maxDominance/o)})));let l=`score: ${fixed2(s.score)}\n${a.map((t=>`+${t.weight}x${t.normalizedDominance} = ${t.partialScore} | +${t.normalizedPartialScore} ${t.name}`)).join("\n")}`;e=e+"<td"+(' class="orange-text"'+ct.attr("title",l,true,false))+">";(function(){var t=star(s.score);if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var o=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=o)?"":i)+"</i>"}}else{var r=0;for(var n in t){r++;var o=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=o)?"":i)+"</i>"}}}).call(this);e=e+"</td>";(function(){var t=h;if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(o.weight>0){let t=`color:${o.color}`;let n=`${o.name}: ${s.evaluations[o.name]}\ndominance: ${s.dominance[o.name]}\nrank: ${s.rank[o.name]}`;e=e+"<td"+(ct.attr("style",ct.style(t),true,false)+ct.attr("title",n,true,false))+"><span>";(function(){var t=star(s.rank[o.name]/(o.classCount-1));if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var a=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=a)?"":i)+"</i>"}}else{var r=0;for(var n in t){r++;var a=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=a)?"":i)+"</i>"}}}).call(this);e=e+"</span></td>"}}}else{var r=0;for(var n in t){r++;var o=t[n];if(o.weight>0){let t=`color:${o.color}`;let n=`${o.name}: ${s.evaluations[o.name]}\ndominance: ${s.dominance[o.name]}\nrank: ${s.rank[o.name]}`;e=e+"<td"+(ct.attr("style",ct.style(t),true,false)+ct.attr("title",n,true,false))+"><span>";(function(){var t=star(s.rank[o.name]/(o.classCount-1));if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var a=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=a)?"":i)+"</i>"}}else{var r=0;for(var n in t){r++;var a=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=a)?"":i)+"</i>"}}}).call(this);e=e+"</span></td>"}}}}).call(this);e=e+"</tr>"}}else{var r=0;for(var n in t){r++;var s=t[n];const o=`background-color:${s.selected?"lightgreen":"white"}`;e=e+"<tr"+(' class="technology"'+ct.attr("data-technology",s.name,true,false)+ct.attr("style",ct.style(o),true,false))+"><td>"+ct.escape(null==(i=s.description)?"":i)+"</td>";const a=h.reduce(((t,e)=>t+e.weight),0);const l=h.map((t=>({name:t.name,weight:fixed2(t.weight),normalizedDominance:fixed2(s.dominance[t.name]/t.maxDominance),partialScore:fixed2(t.weight*s.dominance[t.name]/t.maxDominance),normalizedPartialScore:fixed2(t.weight*s.dominance[t.name]/t.maxDominance/a)})));let c=`score: ${fixed2(s.score)}\n${l.map((t=>`+${t.weight}x${t.normalizedDominance} = ${t.partialScore} | +${t.normalizedPartialScore} ${t.name}`)).join("\n")}`;e=e+"<td"+(' class="orange-text"'+ct.attr("title",c,true,false))+">";(function(){var t=star(s.score);if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var o=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=o)?"":i)+"</i>"}}else{var r=0;for(var n in t){r++;var o=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=o)?"":i)+"</i>"}}}).call(this);e=e+"</td>";(function(){var t=h;if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(o.weight>0){let t=`color:${o.color}`;let n=`${o.name}: ${s.evaluations[o.name]}\ndominance: ${s.dominance[o.name]}\nrank: ${s.rank[o.name]}`;e=e+"<td"+(ct.attr("style",ct.style(t),true,false)+ct.attr("title",n,true,false))+"><span>";(function(){var t=star(s.rank[o.name]/(o.classCount-1));if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var a=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=a)?"":i)+"</i>"}}else{var r=0;for(var n in t){r++;var a=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=a)?"":i)+"</i>"}}}).call(this);e=e+"</span></td>"}}}else{var r=0;for(var n in t){r++;var o=t[n];if(o.weight>0){let t=`color:${o.color}`;let n=`${o.name}: ${s.evaluations[o.name]}\ndominance: ${s.dominance[o.name]}\nrank: ${s.rank[o.name]}`;e=e+"<td"+(ct.attr("style",ct.style(t),true,false)+ct.attr("title",n,true,false))+"><span>";(function(){var t=star(s.rank[o.name]/(o.classCount-1));if("number"==typeof t.length){for(var n=0,r=t.length;n<r;n++){var a=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=a)?"":i)+"</i>"}}else{var r=0;for(var n in t){r++;var a=t[n];e=e+'<i class="material-icons">'+ct.escape(null==(i=a)?"":i)+"</i>"}}}).call(this);e=e+"</span></td>"}}}}).call(this);e=e+"</tr>"}}}).call(this);e=e+"</tbody></table>"}).call(this,"Array"in r?r.Array:typeof Array!=="undefined"?Array:undefined,"Math"in r?r.Math:typeof Math!=="undefined"?Math:undefined,"Number"in r?r.Number:typeof Number!=="undefined"?Number:undefined,"criteria"in r?r.criteria:typeof criteria!=="undefined"?criteria:undefined,"technologies"in r?r.technologies:typeof technologies!=="undefined"?technologies:undefined);return e};lt.twoDimensionControlPanel=function(t){var e="",n={},i;var r=t||{};(function(t){e=e+"<svg>";(function(){var n=t;if("number"==typeof n.length){for(var r=0,s=n.length;r<s;r++){var o=n[r];e=e+"<g"+(' class="draggable"'+ct.attr("id",o.name,true,false))+"><ellipse"+(' cx="15"'+ct.attr("cy",r*15+10,true,false))+"></ellipse><text"+(' x="20"'+ct.attr("y",r*15+10,true,false))+"><tspan>"+ct.escape(null==(i=o.description)?"":i)+"</tspan></text></g>"}}else{var s=0;for(var r in n){s++;var o=n[r];e=e+"<g"+(' class="draggable"'+ct.attr("id",o.name,true,false))+"><ellipse"+(' cx="15"'+ct.attr("cy",r*15+10,true,false))+"></ellipse><text"+(' x="20"'+ct.attr("y",r*15+10,true,false))+"><tspan>"+ct.escape(null==(i=o.description)?"":i)+"</tspan></text></g>"}}}).call(this);e=e+"</svg>"}).call(this,"criteria"in r?r.criteria:typeof criteria!=="undefined"?criteria:undefined);return e};lt.twoSliderControlPanel=function(t){var e="",n={},i;var r=t||{};(function(t){e=e+"<form>";(function(){var n=t;if("number"==typeof n.length){for(var r=0,s=n.length;r<s;r++){var o=n[r];e=e+'<div class="row"><label class="col l2 m12 s12">'+ct.escape(null==(i=o.description)?"":i)+'</label><label class="col l5 m6 s12">weight<div class="range-field"><input'+(' type="range"'+ct.attr("data-criterion",o.name,true,false)+' data-parameter="weight"'+ct.attr("value",o.weight,true,false)+' min="0" max="100" step="1"')+'/></div></label><label class="col l5 m6 s12">Granularity<div class="range-field"><input'+(' type="range"'+ct.attr("data-criterion",o.name,true,false)+' data-parameter="blurIntensity"'+ct.attr("value",o.blurIntensity,true,false)+' min="0" max="1" step="0.01"')+"/></div></label></div>"}}else{var s=0;for(var r in n){s++;var o=n[r];e=e+'<div class="row"><label class="col l2 m12 s12">'+ct.escape(null==(i=o.description)?"":i)+'</label><label class="col l5 m6 s12">weight<div class="range-field"><input'+(' type="range"'+ct.attr("data-criterion",o.name,true,false)+' data-parameter="weight"'+ct.attr("value",o.weight,true,false)+' min="0" max="100" step="1"')+'/></div></label><label class="col l5 m6 s12">Granularity<div class="range-field"><input'+(' type="range"'+ct.attr("data-criterion",o.name,true,false)+' data-parameter="blurIntensity"'+ct.attr("value",o.blurIntensity,true,false)+' min="0" max="1" step="0.01"')+"/></div></label></div>"}}}).call(this);e=e+"</form>"}).call(this,"criteria"in r?r.criteria:typeof criteria!=="undefined"?criteria:undefined);return e};const ft=new Intl.DateTimeFormat("en",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});const formatedDate=()=>{const t=ft.formatToParts(new Date).reduce(((t,e)=>{t[e.type]=e.value;return t}),{});return`${t.year}${t.month}${t.day}_${t.hour}${t.minute}${t.second}`};const mt={quotes:true,quoteChar:'"',escapeChar:'"',delimiter:",",header:true,newline:"\r\n",skipEmptyLines:true,columns:null};class Downloader{constructor(t){[this.anchor]=$(t).find("a");$(t).click((t=>{console.log("click");this.saveData()}))}updateCSV(t){if(this.anchor.href)window.URL.revokeObjectURL(this.anchor.href);this.csv=Papa.unparse({fields:["name","description","score"],data:t.sorted},mt);const e=new Blob([this.csv],{type:"text/csv"}),n=window.URL.createObjectURL(e);this.anchor.href=n}saveData(){this.anchor.download=`data_${formatedDate()}.csv`}}class Log{constructor(t,e){if(e===Criterion.eventType.weightUpdated){this.newValue=t.weight}if(e===Criterion.eventType.blurIntensityUpdated){this.newValue=t.blurIntensity}this.time=new Date;this.criterion=t;this.type=e}}class Logs{constructor(){this.data=[]}updateData(t,e){this.data.push(new Log(t,e))}}window.SVG=n;const pt=new Sorter([],[]);let gt=null;let yt;let xt=null;$(load());$("#csv").on("change",(function(t){loadFromCSV(t.target.files[0])}));$("#loadDB").on("click",loadDataFromDb);function load(){if(localStorage.getItem("criteria")===null){loadDataFromDb()}else{loadDataLocally()}}function cleanUI(){$("#controlPanel").empty();$("#ParallelCoordinatesPlotPanel").empty();$("#logs").empty()}async function loadDataFromDb(){cleanUI();const[t,e]=await Promise.all([getCriteria(),getTechnologies()]);initSorter(t,e)}function saveDataLocally(){localStorage.setItem("criteria",JSON.stringify(pt.criteria.all));localStorage.setItem("technologies",JSON.stringify(pt.technologies.all))}function loadDataLocally(){const t=JSON.parse(localStorage.getItem("criteria"));const e=JSON.parse(localStorage.getItem("technologies"));initSorter(t,e)}const parseNameOrder=t=>{const e=t.match(/\((ASC|DESC)\)$/);const n=t.replace(/\((ASC|DESC)\)$/,"").trim();const i={ASC:"ascending",DESC:"descending"};return e?[t,n,i[e[1]]]:[t,n,i["ASC"]]};const reduceMin=t=>(e,n)=>n[t]<e?n[t]:e;const reduceMax=t=>(e,n)=>n[t]>e?n[t]:e;const filterFieldOut=([,t])=>t!="name"&&t!="description"&&t!="technology";function loadFromCSV(t){Papa.parse(t,{download:true,header:true,worker:true,skipEmptyLines:true,dynamicTyping:true,complete:function(t){const e=t.meta.fields.map(parseNameOrder).filter(filterFieldOut).map((([e,n,i])=>({name:n,description:n,min:t.data.reduce(reduceMin(e),t.data[0][e]),max:t.data.reduce(reduceMax(e),t.data[0][e]),sortingorder:i})));const n=t.data.map(((t,e)=>{if(t===undefined)return;const n={technology:e,name:t.name||e,description:t.description||t.name||`${Math.ceil(100*t.TS)}_${Math.ceil(100*t.WFS)}`,evaluations:Object.entries(t).filter((([t,e])=>t!="name"&&t!="description"&&t!="technology")).map((([t,e])=>[parseNameOrder(t)[1],e])).reduce(((t,[e,n])=>({...t,[e]:n})),{})};return n}));initSorter(e,n)}})}async function getCriteria(){const t=await fetch("/api/criteria");const e=await t.json();return e.criteria}async function getTechnologies(){const t=await fetch("/api/technologies");const e=await t.json();return e.technologies}function initSorter(t,e){cleanUI();pt.criteria=t;pt.technologies=e;saveDataLocally();xt=new Logs;gt=new UI($("#controlPanel")[0],pt.criteria.all,(()=>{loadState();attachEventListener()}));yt=new ParallelCoordinatesPlotPanel($("#ParallelCoordinatesPlotPanel")[0])}function loadState(){if(localStorage.getItem("sorterCriteria")===null){pt.criteria.all[0].weight=1}else{let e=JSON.parse(localStorage.getItem("sorterCriteria"));for(var t=0;t<e.length;t++){let n=e[t];if(!pt.criteria.map[n.name])continue;pt.criteria.map[n.name].weight=n.weight;pt.criteria.map[n.name].blurIntensity=n.blurIntensity}updateUI()}}function saveToLocalStorage(){const t=pt.criteria.all.map((t=>t.export()));const e=JSON.parse(localStorage.getItem("sorterCriteria"))||[];const n=e.filter((e=>!(t.find((t=>t.name===e.name))?.weight<0)));const i=n.map((e=>{const n=t.find((t=>t.name===e.name));if(n?.weight>0){e.weight=n.weight;e.blurIntensity=n.blurIntensity}return e}));const r=t.filter((t=>!i.find((e=>e.name===t.name))));const s=[...i,...r];localStorage.setItem("sorterCriteria",JSON.stringify(s))}function attachEventListener(){const t=new Downloader($("#saveButton")[0]);for(var e=0;e<pt.criteria.all.length;e++){let t=pt.criteria.all[e];t.on(Criterion.eventType.blurIntensityUpdated,((t,e)=>xt.updateData(e,t)));t.on(Criterion.eventType.weightUpdated,((t,e)=>xt.updateData(e,t)))}let n=null;pt.on(Sorter.eventType.sorted,(e=>{clearTimeout(n);n=setTimeout((()=>{updateUI()}),100);updateUI(10);saveToLocalStorage();t.updateCSV(pt.technologies)}))}function updateUI(t){updateTable(t);loadParallelCoordinatesPlotPanel()}function updateTable(t){t=t?t:pt.technologies.sorted.length;try{$("#result").empty().append(lt.table({technologies:pt.technologies.sorted.slice(0,t),criteria:pt.criteria.all}));makeTableInteractive()}catch(t){console.log(t)}}function makeTableInteractive(){$("#result tbody").on("click","tr.technology",(function(t){const e=$(t.target).parents("tr.technology")[0];console.log(e.dataset.technology);if(e.dataset.technology){const t=pt.technologies.map[e.dataset.technology];t.selected=!t.selected;updateTable();loadParallelCoordinatesPlotPanel()}}));let t=null;$("#result tbody").on("mouseover","tr.technology",(function(e){if(e.buttons===1){const n=$(e.target).parents("tr.technology")[0];console.log(n.dataset.technology);if(n.dataset.technology){const e=pt.technologies.map[n.dataset.technology];e.selected=!e.selected;n.style.backgroundColor=e.selected?"yellow":"white";loadParallelCoordinatesPlotPanel();clearTimeout(t);t=setTimeout((()=>{updateUI()}),100)}}}))}function loadControlPanel(t){if(t==="2Dimension"){load2DimensionControlPanel()}else{load2SliderControlPanel()}}function load2SliderControlPanel(){$("#controlPanel").empty().append(template.twoSliderControlPanel({criteria:pt.criteria.all})).find("input").change((function(t){const e=$(t.target),n=e.data("criterion"),i=e.data("parameter"),r=pt.criteria.map[n];r[i]=e.val()}))}function load2DimensionControlPanel(){$("#controlPanel").empty().append(template.twoDimensionControlPanel({criteria:pt.criteria.all})).find(".draggable").each((function(){const t=gt.svg(this);t.mousedown((function(e){const n=t.ellipse().draggable().move(2.5+e.offsetX,2.5+e.offsetY);n.remember("_draggable").startDrag(e)}))}))}function loadParallelCoordinatesPlotPanel(t){t=t?t:pt.technologies.sorted.length;if(pt.criteria.all.filter((t=>t.weight>0)).length<2)return;const e=pt.criteria.all.filter((t=>t.weight>0)).sort(((t,e)=>t.weight-e.weight));yt.update(pt.technologies.sorted.slice(0,t),e)}