#!/usr/bin/env node

/**
 * Module dependencies.
 */
import * as httpHandlers from "../src/httpHandler.mjs" ;
import app from "../app.mjs" ;
import debug from "debug" ;
import http from "http" ;
import normalizePort from "../src/normalizePort.mjs" ;

debug( "rezbuild-capuchin:server" ) ;

/**
 * Get port from environment and store in Express.
 */
const port = normalizePort( process.env.PORT || "3000" ) ;
app.set( "port", port ) ;

/**
 * Create HTTP server.
 */
const server = http.createServer( app ) ;

/**
 * Listen on provided port, on all network interfaces.
 */
server.listen( port ) ;
server.on( "error", httpHandlers.errorHandler( port ) ) ;
server.on( "listening", httpHandlers.listeningHandler( server ) ) ;
